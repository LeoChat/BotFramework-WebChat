'use strict';

var cov_vi1971513 = (function() {
  var path = '/Users/guy/Work/Leo/leo/BotFramework-WebChat/packages/component/src/BasicTranscript.js';
  var hash = 'e7011f1acc275842674db2a1e8e0a75c99648fe1';
  var global = new Function('return this')();
  var gcv = '__coverage__';
  var coverageData = {
    path: '/Users/guy/Work/Leo/leo/BotFramework-WebChat/packages/component/src/BasicTranscript.js',
    statementMap: {
      '0': {
        start: {
          line: 12,
          column: 17
        },
        end: {
          line: 15,
          column: 2
        }
      },
      '1': {
        start: {
          line: 17,
          column: 18
        },
        end: {
          line: 21,
          column: 2
        }
      },
      '2': {
        start: {
          line: 23,
          column: 19
        },
        end: {
          line: 25,
          column: 2
        }
      },
      '3': {
        start: {
          line: 27,
          column: 17
        },
        end: {
          line: 33,
          column: 2
        }
      },
      '4': {
        start: {
          line: 35,
          column: 32
        },
        end: {
          line: 35,
          column: 38
        }
      },
      '5': {
        start: {
          line: 38,
          column: 2
        },
        end: {
          line: 49,
          column: 3
        }
      },
      '6': {
        start: {
          line: 39,
          column: 4
        },
        end: {
          line: 39,
          column: 16
        }
      },
      '7': {
        start: {
          line: 40,
          column: 9
        },
        end: {
          line: 49,
          column: 3
        }
      },
      '8': {
        start: {
          line: 41,
          column: 4
        },
        end: {
          line: 41,
          column: 99
        }
      },
      '9': {
        start: {
          line: 43,
          column: 4
        },
        end: {
          line: 48,
          column: 5
        }
      },
      '10': {
        start: {
          line: 44,
          column: 20
        },
        end: {
          line: 44,
          column: 59
        }
      },
      '11': {
        start: {
          line: 45,
          column: 20
        },
        end: {
          line: 45,
          column: 59
        }
      },
      '12': {
        start: {
          line: 47,
          column: 6
        },
        end: {
          line: 47,
          column: 55
        }
      },
      '13': {
        start: {
          line: 51,
          column: 2
        },
        end: {
          line: 51,
          column: 15
        }
      },
      '14': {
        start: {
          line: 54,
          column: 24
        },
        end: {
          line: 122,
          column: 1
        }
      },
      '15': {
        start: {
          line: 63,
          column: 56
        },
        end: {
          line: 63,
          column: 79
        }
      },
      '16': {
        start: {
          line: 69,
          column: 27
        },
        end: {
          line: 82,
          column: 8
        }
      },
      '17': {
        start: {
          line: 70,
          column: 20
        },
        end: {
          line: 73,
          column: 72
        }
      },
      '18': {
        start: {
          line: 73,
          column: 27
        },
        end: {
          line: 73,
          column: 71
        }
      },
      '19': {
        start: {
          line: 75,
          column: 4
        },
        end: {
          line: 79,
          column: 9
        }
      },
      '20': {
        start: {
          line: 81,
          column: 4
        },
        end: {
          line: 81,
          column: 28
        }
      },
      '21': {
        start: {
          line: 84,
          column: 2
        },
        end: {
          line: 121,
          column: 4
        }
      },
      '22': {
        start: {
          line: 97,
          column: 14
        },
        end: {
          line: 114,
          column: 19
        }
      },
      '23': {
        start: {
          line: 124,
          column: 0
        },
        end: {
          line: 128,
          column: 2
        }
      },
      '24': {
        start: {
          line: 130,
          column: 0
        },
        end: {
          line: 147,
          column: 2
        }
      },
      '25': {
        start: {
          line: 150,
          column: 106
        },
        end: {
          line: 157,
          column: 3
        }
      }
    },
    fnMap: {
      '0': {
        name: 'sameTimestampGroup',
        decl: {
          start: {
            line: 37,
            column: 9
          },
          end: {
            line: 37,
            column: 27
          }
        },
        loc: {
          start: {
            line: 37,
            column: 66
          },
          end: {
            line: 52,
            column: 1
          }
        },
        line: 37
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 54,
            column: 24
          },
          end: {
            line: 54,
            column: 25
          }
        },
        loc: {
          start: {
            line: 62,
            column: 6
          },
          end: {
            line: 122,
            column: 1
          }
        },
        line: 62
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 69,
            column: 45
          },
          end: {
            line: 69,
            column: 46
          }
        },
        loc: {
          start: {
            line: 69,
            column: 77
          },
          end: {
            line: 82,
            column: 3
          }
        },
        line: 69
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 73,
            column: 7
          },
          end: {
            line: 73,
            column: 8
          }
        },
        loc: {
          start: {
            line: 73,
            column: 27
          },
          end: {
            line: 73,
            column: 71
          }
        },
        line: 73
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 96,
            column: 34
          },
          end: {
            line: 96,
            column: 35
          }
        },
        loc: {
          start: {
            line: 97,
            column: 14
          },
          end: {
            line: 114,
            column: 19
          }
        },
        line: 97
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 150,
            column: 2
          },
          end: {
            line: 150,
            column: 3
          }
        },
        loc: {
          start: {
            line: 150,
            column: 106
          },
          end: {
            line: 157,
            column: 3
          }
        },
        line: 150
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 38,
            column: 2
          },
          end: {
            line: 49,
            column: 3
          }
        },
        type: 'if',
        locations: [
          {
            start: {
              line: 38,
              column: 2
            },
            end: {
              line: 49,
              column: 3
            }
          },
          {
            start: {
              line: 38,
              column: 2
            },
            end: {
              line: 49,
              column: 3
            }
          }
        ],
        line: 38
      },
      '1': {
        loc: {
          start: {
            line: 40,
            column: 9
          },
          end: {
            line: 49,
            column: 3
          }
        },
        type: 'if',
        locations: [
          {
            start: {
              line: 40,
              column: 9
            },
            end: {
              line: 49,
              column: 3
            }
          },
          {
            start: {
              line: 40,
              column: 9
            },
            end: {
              line: 49,
              column: 3
            }
          }
        ],
        line: 40
      },
      '2': {
        loc: {
          start: {
            line: 40,
            column: 13
          },
          end: {
            line: 40,
            column: 35
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 40,
              column: 13
            },
            end: {
              line: 40,
              column: 22
            }
          },
          {
            start: {
              line: 40,
              column: 26
            },
            end: {
              line: 40,
              column: 35
            }
          }
        ],
        line: 40
      },
      '3': {
        loc: {
          start: {
            line: 41,
            column: 21
          },
          end: {
            line: 41,
            column: 98
          }
        },
        type: 'cond-expr',
        locations: [
          {
            start: {
              line: 41,
              column: 58
            },
            end: {
              line: 41,
              column: 72
            }
          },
          {
            start: {
              line: 41,
              column: 75
            },
            end: {
              line: 41,
              column: 98
            }
          }
        ],
        line: 41
      },
      '4': {
        loc: {
          start: {
            line: 43,
            column: 4
          },
          end: {
            line: 48,
            column: 5
          }
        },
        type: 'if',
        locations: [
          {
            start: {
              line: 43,
              column: 4
            },
            end: {
              line: 48,
              column: 5
            }
          },
          {
            start: {
              line: 43,
              column: 4
            },
            end: {
              line: 48,
              column: 5
            }
          }
        ],
        line: 43
      },
      '5': {
        loc: {
          start: {
            line: 63,
            column: 56
          },
          end: {
            line: 63,
            column: 79
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 63,
              column: 56
            },
            end: {
              line: 63,
              column: 73
            }
          },
          {
            start: {
              line: 63,
              column: 77
            },
            end: {
              line: 63,
              column: 79
            }
          }
        ],
        line: 63
      },
      '6': {
        loc: {
          start: {
            line: 75,
            column: 4
          },
          end: {
            line: 79,
            column: 8
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 75,
              column: 4
            },
            end: {
              line: 75,
              column: 11
            }
          },
          {
            start: {
              line: 76,
              column: 6
            },
            end: {
              line: 79,
              column: 8
            }
          }
        ],
        line: 75
      },
      '7': {
        loc: {
          start: {
            line: 104,
            column: 21
          },
          end: {
            line: 104,
            column: 54
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 104,
              column: 21
            },
            end: {
              line: 104,
              column: 48
            }
          },
          {
            start: {
              line: 104,
              column: 52
            },
            end: {
              line: 104,
              column: 54
            }
          }
        ],
        line: 104
      },
      '8': {
        loc: {
          start: {
            line: 108,
            column: 21
          },
          end: {
            line: 108,
            column: 108
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 108,
              column: 22
            },
            end: {
              line: 108,
              column: 42
            }
          },
          {
            start: {
              line: 108,
              column: 46
            },
            end: {
              line: 108,
              column: 83
            }
          },
          {
            start: {
              line: 108,
              column: 88
            },
            end: {
              line: 108,
              column: 99
            }
          },
          {
            start: {
              line: 108,
              column: 103
            },
            end: {
              line: 108,
              column: 108
            }
          }
        ],
        line: 108
      },
      '9': {
        loc: {
          start: {
            line: 113,
            column: 16
          },
          end: {
            line: 113,
            column: 107
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 113,
              column: 16
            },
            end: {
              line: 113,
              column: 36
            }
          },
          {
            start: {
              line: 113,
              column: 40
            },
            end: {
              line: 113,
              column: 66
            }
          },
          {
            start: {
              line: 113,
              column: 70
            },
            end: {
              line: 113,
              column: 107
            }
          }
        ],
        line: 113
      },
      '10': {
        loc: {
          start: {
            line: 119,
            column: 7
          },
          end: {
            line: 119,
            column: 71
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 119,
              column: 7
            },
            end: {
              line: 119,
              column: 46
            }
          },
          {
            start: {
              line: 119,
              column: 50
            },
            end: {
              line: 119,
              column: 71
            }
          }
        ],
        line: 119
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0
    },
    b: {
      '0': [0, 0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0],
      '4': [0, 0],
      '5': [0, 0],
      '6': [0, 0],
      '7': [0, 0],
      '8': [0, 0, 0, 0],
      '9': [0, 0, 0],
      '10': [0, 0]
    },
    _coverageSchema: '43e27e138ebf9cfc5966b082cf9a028302ed4184',
    hash: 'e7011f1acc275842674db2a1e8e0a75c99648fe1'
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  return (coverage[path] = coverageData);
})();

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.default = void 0;

var _reactSay = require('react-say');

var _glamor = require('glamor');

var _reactScrollToBottom = require('react-scroll-to-bottom');

var _classnames = _interopRequireDefault(require('classnames'));

var _propTypes = _interopRequireDefault(require('prop-types'));

var _react = _interopRequireDefault(require('react'));

var _connectToWebChat = _interopRequireDefault(require('./connectToWebChat'));

var _ScrollToEndButton = _interopRequireDefault(require('./Activity/ScrollToEndButton'));

var _Speak = _interopRequireDefault(require('./Activity/Speak'));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

var ROOT_CSS =
  (cov_vi1971513.s[0]++,
  (0, _glamor.css)({
    overflow: 'hidden',
    position: 'relative'
  }));
var PANEL_CSS =
  (cov_vi1971513.s[1]++,
  (0, _glamor.css)({
    display: 'flex',
    flexDirection: 'column',
    WebkitOverflowScrolling: 'touch'
  }));
var FILLER_CSS =
  (cov_vi1971513.s[2]++,
  (0, _glamor.css)({
    flex: 1
  }));
var LIST_CSS =
  (cov_vi1971513.s[3]++,
  (0, _glamor.css)({
    listStyleType: 'none',
    '& > li.hide-timestamp .transcript-timestamp': {
      display: 'none'
    }
  }));
var DEFAULT_GROUP_TIMESTAMP = (cov_vi1971513.s[4]++, 300000); // 5 minutes

function sameTimestampGroup(activityX, activityY, groupTimestamp) {
  cov_vi1971513.f[0]++;
  cov_vi1971513.s[5]++;

  if (groupTimestamp === false) {
    cov_vi1971513.b[0][0]++;
    cov_vi1971513.s[6]++;
    return true;
  } else {
    cov_vi1971513.b[0][1]++;
    cov_vi1971513.s[7]++;

    if ((cov_vi1971513.b[2][0]++, activityX) && (cov_vi1971513.b[2][1]++, activityY)) {
      cov_vi1971513.b[1][0]++;
      cov_vi1971513.s[8]++;
      groupTimestamp =
        typeof groupTimestamp === 'number'
          ? (cov_vi1971513.b[3][0]++, groupTimestamp)
          : (cov_vi1971513.b[3][1]++, DEFAULT_GROUP_TIMESTAMP);
      cov_vi1971513.s[9]++;

      if (activityX.from.role === activityY.from.role) {
        cov_vi1971513.b[4][0]++;
        var timeX = (cov_vi1971513.s[10]++, new Date(activityX.timestamp).getTime());
        var timeY = (cov_vi1971513.s[11]++, new Date(activityY.timestamp).getTime());
        cov_vi1971513.s[12]++;
        return Math.abs(timeX - timeY) <= groupTimestamp;
      } else {
        cov_vi1971513.b[4][1]++;
      }
    } else {
      cov_vi1971513.b[1][1]++;
    }
  }

  cov_vi1971513.s[13]++;
  return false;
}

cov_vi1971513.s[14]++;

var BasicTranscript = function BasicTranscript(_ref) {
  var activityRenderer = _ref.activityRenderer,
    activities = _ref.activities,
    attachmentRenderer = _ref.attachmentRenderer,
    className = _ref.className,
    groupTimestamp = _ref.groupTimestamp,
    styleSet = _ref.styleSet,
    webSpeechPonyfill = _ref.webSpeechPonyfill;
  cov_vi1971513.f[1]++;

  var _ref2 = (cov_vi1971513.s[15]++, (cov_vi1971513.b[5][0]++, webSpeechPonyfill) || (cov_vi1971513.b[5][1]++, {})),
    speechSynthesis = _ref2.speechSynthesis,
    SpeechSynthesisUtterance = _ref2.SpeechSynthesisUtterance; // We use 2-pass approach for rendering activities, for show/hide timestamp grouping.
  // Until the activity pass thru middleware, we never know if it is going to show up.
  // After we know which activities will show up, we can compute which activity will show timestamps.
  // If the activity does not render, it will not be spoken if text-to-speech is enabled.

  var activityElements =
    (cov_vi1971513.s[16]++,
    activities.reduce(function(activityElements, activity) {
      cov_vi1971513.f[2]++;
      var element =
        (cov_vi1971513.s[17]++,
        activityRenderer({
          activity: activity,
          timestampClassName: 'transcript-timestamp'
        })(function(_ref3) {
          var attachment = _ref3.attachment;
          cov_vi1971513.f[3]++;
          cov_vi1971513.s[18]++;
          return attachmentRenderer({
            activity: activity,
            attachment: attachment
          });
        }));
      cov_vi1971513.s[19]++;
      (cov_vi1971513.b[6][0]++, element) &&
        (cov_vi1971513.b[6][1]++,
        activityElements.push({
          activity: activity,
          element: element
        }));
      cov_vi1971513.s[20]++;
      return activityElements;
    }, []));
  cov_vi1971513.s[21]++;
  return _react.default.createElement(
    'div',
    {
      className: (0, _classnames.default)(ROOT_CSS + '', className + ''),
      role: 'log'
    },
    _react.default.createElement(
      _reactScrollToBottom.Panel,
      {
        className: PANEL_CSS + ''
      },
      _react.default.createElement('div', {
        className: FILLER_CSS
      }),
      _react.default.createElement(
        _reactSay.Composer,
        {
          speechSynthesis: speechSynthesis,
          speechSynthesisUtterance: SpeechSynthesisUtterance
        },
        _react.default.createElement(
          'ul',
          {
            'aria-atomic': 'false',
            'aria-live': 'polite',
            'aria-relevant': 'additions text',
            className: (0, _classnames.default)(LIST_CSS + '', styleSet.activities + ''),
            role: 'list'
          },
          activityElements.map(function(_ref4, index) {
            var activity = _ref4.activity,
              element = _ref4.element;
            cov_vi1971513.f[4]++;
            cov_vi1971513.s[22]++;
            return _react.default.createElement(
              'li',
              {
                /* Because of differences in browser implementations, aria-label=" " is used to make the screen reader not repeat the same text multiple times in Chrome v75 */
                'aria-label': ' ',
                className: (0, _classnames.default)(styleSet.activity + '', {
                  // Hide timestamp if same timestamp group with the next activity
                  'hide-timestamp': sameTimestampGroup(
                    activity,
                    ((cov_vi1971513.b[7][0]++, activityElements[index + 1]) || (cov_vi1971513.b[7][1]++, {})).activity,
                    groupTimestamp
                  )
                }),
                key:
                  ((cov_vi1971513.b[8][0]++, activity.channelData) &&
                    (cov_vi1971513.b[8][1]++, activity.channelData.clientActivityID)) ||
                  (cov_vi1971513.b[8][2]++, activity.id) ||
                  (cov_vi1971513.b[8][3]++, index),
                role: 'listitem'
              },
              element, // TODO: [P2] We should use core/definitions/speakingActivity for this predicate instead
              (cov_vi1971513.b[9][0]++, activity.channelData) &&
                (cov_vi1971513.b[9][1]++, activity.channelData.speak) &&
                (cov_vi1971513.b[9][2]++,
                _react.default.createElement(_Speak.default, {
                  activity: activity
                }))
            );
          })
        )
      )
    ),
    (cov_vi1971513.b[10][0]++, !styleSet.options.hideScrollToEndButton) &&
      (cov_vi1971513.b[10][1]++, _react.default.createElement(_ScrollToEndButton.default, null))
  );
};

cov_vi1971513.s[23]++;
BasicTranscript.defaultProps = {
  className: '',
  groupTimestamp: true,
  webSpeechPonyfill: undefined
};
cov_vi1971513.s[24]++;
BasicTranscript.propTypes = {
  activities: _propTypes.default.array.isRequired,
  activityRenderer: _propTypes.default.func.isRequired,
  attachmentRenderer: _propTypes.default.func.isRequired,
  className: _propTypes.default.string,
  groupTimestamp: _propTypes.default.oneOfType([
    _propTypes.default.bool.isRequired,
    _propTypes.default.number.isRequired
  ]),
  styleSet: _propTypes.default.shape({
    activities: _propTypes.default.any.isRequired,
    activity: _propTypes.default.any.isRequired,
    options: _propTypes.default.shape({
      hideScrollToEndButton: _propTypes.default.bool.isRequired
    }).isRequired
  }).isRequired,
  webSpeechPonyfill: _propTypes.default.shape({
    speechSynthesis: _propTypes.default.any.isRequired,
    SpeechSynthesisUtterance: _propTypes.default.any.isRequired
  })
};

var _default = (0, _connectToWebChat.default)(function(_ref5) {
  var activities = _ref5.activities,
    activityRenderer = _ref5.activityRenderer,
    attachmentRenderer = _ref5.attachmentRenderer,
    groupTimestamp = _ref5.groupTimestamp,
    styleSet = _ref5.styleSet,
    webSpeechPonyfill = _ref5.webSpeechPonyfill;
  cov_vi1971513.f[5]++;
  cov_vi1971513.s[25]++;
  return {
    activities: activities,
    activityRenderer: activityRenderer,
    attachmentRenderer: attachmentRenderer,
    groupTimestamp: groupTimestamp,
    styleSet: styleSet,
    webSpeechPonyfill: webSpeechPonyfill
  };
})(BasicTranscript);

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9CYXNpY1RyYW5zY3JpcHQuanMiXSwibmFtZXMiOlsiUk9PVF9DU1MiLCJvdmVyZmxvdyIsInBvc2l0aW9uIiwiUEFORUxfQ1NTIiwiZGlzcGxheSIsImZsZXhEaXJlY3Rpb24iLCJXZWJraXRPdmVyZmxvd1Njcm9sbGluZyIsIkZJTExFUl9DU1MiLCJmbGV4IiwiTElTVF9DU1MiLCJsaXN0U3R5bGVUeXBlIiwiREVGQVVMVF9HUk9VUF9USU1FU1RBTVAiLCJzYW1lVGltZXN0YW1wR3JvdXAiLCJhY3Rpdml0eVgiLCJhY3Rpdml0eVkiLCJncm91cFRpbWVzdGFtcCIsImZyb20iLCJyb2xlIiwidGltZVgiLCJEYXRlIiwidGltZXN0YW1wIiwiZ2V0VGltZSIsInRpbWVZIiwiTWF0aCIsImFicyIsIkJhc2ljVHJhbnNjcmlwdCIsImFjdGl2aXR5UmVuZGVyZXIiLCJhY3Rpdml0aWVzIiwiYXR0YWNobWVudFJlbmRlcmVyIiwiY2xhc3NOYW1lIiwic3R5bGVTZXQiLCJ3ZWJTcGVlY2hQb255ZmlsbCIsInNwZWVjaFN5bnRoZXNpcyIsIlNwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZSIsImFjdGl2aXR5RWxlbWVudHMiLCJyZWR1Y2UiLCJhY3Rpdml0eSIsImVsZW1lbnQiLCJ0aW1lc3RhbXBDbGFzc05hbWUiLCJhdHRhY2htZW50IiwicHVzaCIsIm1hcCIsImluZGV4IiwiY2hhbm5lbERhdGEiLCJjbGllbnRBY3Rpdml0eUlEIiwiaWQiLCJzcGVhayIsIm9wdGlvbnMiLCJoaWRlU2Nyb2xsVG9FbmRCdXR0b24iLCJkZWZhdWx0UHJvcHMiLCJ1bmRlZmluZWQiLCJwcm9wVHlwZXMiLCJQcm9wVHlwZXMiLCJhcnJheSIsImlzUmVxdWlyZWQiLCJmdW5jIiwic3RyaW5nIiwib25lT2ZUeXBlIiwiYm9vbCIsIm51bWJlciIsInNoYXBlIiwiYW55Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOzs7O0FBRUEsSUFBTUEsUUFBUSww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QSxrQkFIc0c7QUFJdEdiLElBQUFBLGNBQWMsRUFBZEEsY0FKc0c7QUFLdEdlLElBQUFBLFFBQVEsRUFBUkEsUUFMc0c7QUFNdEdDLElBQUFBLGlCQUFpQixFQUFqQkE7QUFOc0c7QUFPdkcsQ0FSWSxFQVNiTixlQVRhLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb3NlciBhcyBTYXlDb21wb3NlciB9IGZyb20gJ3JlYWN0LXNheSc7XG5pbXBvcnQgeyBjc3MgfSBmcm9tICdnbGFtb3InO1xuaW1wb3J0IHsgUGFuZWwgYXMgU2Nyb2xsVG9Cb3R0b21QYW5lbCB9IGZyb20gJ3JlYWN0LXNjcm9sbC10by1ib3R0b20nO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IGNvbm5lY3RUb1dlYkNoYXQgZnJvbSAnLi9jb25uZWN0VG9XZWJDaGF0JztcbmltcG9ydCBTY3JvbGxUb0VuZEJ1dHRvbiBmcm9tICcuL0FjdGl2aXR5L1Njcm9sbFRvRW5kQnV0dG9uJztcbmltcG9ydCBTcGVha0FjdGl2aXR5IGZyb20gJy4vQWN0aXZpdHkvU3BlYWsnO1xuXG5jb25zdCBST09UX0NTUyA9IGNzcyh7XG4gIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgcG9zaXRpb246ICdyZWxhdGl2ZSdcbn0pO1xuXG5jb25zdCBQQU5FTF9DU1MgPSBjc3Moe1xuICBkaXNwbGF5OiAnZmxleCcsXG4gIGZsZXhEaXJlY3Rpb246ICdjb2x1bW4nLFxuICBXZWJraXRPdmVyZmxvd1Njcm9sbGluZzogJ3RvdWNoJ1xufSk7XG5cbmNvbnN0IEZJTExFUl9DU1MgPSBjc3Moe1xuICBmbGV4OiAxXG59KTtcblxuY29uc3QgTElTVF9DU1MgPSBjc3Moe1xuICBsaXN0U3R5bGVUeXBlOiAnbm9uZScsXG5cbiAgJyYgPiBsaS5oaWRlLXRpbWVzdGFtcCAudHJhbnNjcmlwdC10aW1lc3RhbXAnOiB7XG4gICAgZGlzcGxheTogJ25vbmUnXG4gIH1cbn0pO1xuXG5jb25zdCBERUZBVUxUX0dST1VQX1RJTUVTVEFNUCA9IDMwMDAwMDsgLy8gNSBtaW51dGVzXG5cbmZ1bmN0aW9uIHNhbWVUaW1lc3RhbXBHcm91cChhY3Rpdml0eVgsIGFjdGl2aXR5WSwgZ3JvdXBUaW1lc3RhbXApIHtcbiAgaWYgKGdyb3VwVGltZXN0YW1wID09PSBmYWxzZSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9IGVsc2UgaWYgKGFjdGl2aXR5WCAmJiBhY3Rpdml0eVkpIHtcbiAgICBncm91cFRpbWVzdGFtcCA9IHR5cGVvZiBncm91cFRpbWVzdGFtcCA9PT0gJ251bWJlcicgPyBncm91cFRpbWVzdGFtcCA6IERFRkFVTFRfR1JPVVBfVElNRVNUQU1QO1xuXG4gICAgaWYgKGFjdGl2aXR5WC5mcm9tLnJvbGUgPT09IGFjdGl2aXR5WS5mcm9tLnJvbGUpIHtcbiAgICAgIGNvbnN0IHRpbWVYID0gbmV3IERhdGUoYWN0aXZpdHlYLnRpbWVzdGFtcCkuZ2V0VGltZSgpO1xuICAgICAgY29uc3QgdGltZVkgPSBuZXcgRGF0ZShhY3Rpdml0eVkudGltZXN0YW1wKS5nZXRUaW1lKCk7XG5cbiAgICAgIHJldHVybiBNYXRoLmFicyh0aW1lWCAtIHRpbWVZKSA8PSBncm91cFRpbWVzdGFtcDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59XG5cbmNvbnN0IEJhc2ljVHJhbnNjcmlwdCA9ICh7XG4gIGFjdGl2aXR5UmVuZGVyZXIsXG4gIGFjdGl2aXRpZXMsXG4gIGF0dGFjaG1lbnRSZW5kZXJlcixcbiAgY2xhc3NOYW1lLFxuICBncm91cFRpbWVzdGFtcCxcbiAgc3R5bGVTZXQsXG4gIHdlYlNwZWVjaFBvbnlmaWxsXG59KSA9PiB7XG4gIGNvbnN0IHsgc3BlZWNoU3ludGhlc2lzLCBTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2UgfSA9IHdlYlNwZWVjaFBvbnlmaWxsIHx8IHt9O1xuXG4gIC8vIFdlIHVzZSAyLXBhc3MgYXBwcm9hY2ggZm9yIHJlbmRlcmluZyBhY3Rpdml0aWVzLCBmb3Igc2hvdy9oaWRlIHRpbWVzdGFtcCBncm91cGluZy5cbiAgLy8gVW50aWwgdGhlIGFjdGl2aXR5IHBhc3MgdGhydSBtaWRkbGV3YXJlLCB3ZSBuZXZlciBrbm93IGlmIGl0IGlzIGdvaW5nIHRvIHNob3cgdXAuXG4gIC8vIEFmdGVyIHdlIGtub3cgd2hpY2ggYWN0aXZpdGllcyB3aWxsIHNob3cgdXAsIHdlIGNhbiBjb21wdXRlIHdoaWNoIGFjdGl2aXR5IHdpbGwgc2hvdyB0aW1lc3RhbXBzLlxuICAvLyBJZiB0aGUgYWN0aXZpdHkgZG9lcyBub3QgcmVuZGVyLCBpdCB3aWxsIG5vdCBiZSBzcG9rZW4gaWYgdGV4dC10by1zcGVlY2ggaXMgZW5hYmxlZC5cbiAgY29uc3QgYWN0aXZpdHlFbGVtZW50cyA9IGFjdGl2aXRpZXMucmVkdWNlKChhY3Rpdml0eUVsZW1lbnRzLCBhY3Rpdml0eSkgPT4ge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBhY3Rpdml0eVJlbmRlcmVyKHtcbiAgICAgIGFjdGl2aXR5LFxuICAgICAgdGltZXN0YW1wQ2xhc3NOYW1lOiAndHJhbnNjcmlwdC10aW1lc3RhbXAnXG4gICAgfSkoKHsgYXR0YWNobWVudCB9KSA9PiBhdHRhY2htZW50UmVuZGVyZXIoeyBhY3Rpdml0eSwgYXR0YWNobWVudCB9KSk7XG5cbiAgICBlbGVtZW50ICYmXG4gICAgICBhY3Rpdml0eUVsZW1lbnRzLnB1c2goe1xuICAgICAgICBhY3Rpdml0eSxcbiAgICAgICAgZWxlbWVudFxuICAgICAgfSk7XG5cbiAgICByZXR1cm4gYWN0aXZpdHlFbGVtZW50cztcbiAgfSwgW10pO1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9e2NsYXNzTmFtZXMoUk9PVF9DU1MgKyAnJywgY2xhc3NOYW1lICsgJycpfSByb2xlPVwibG9nXCI+XG4gICAgICA8U2Nyb2xsVG9Cb3R0b21QYW5lbCBjbGFzc05hbWU9e1BBTkVMX0NTUyArICcnfT5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9e0ZJTExFUl9DU1N9IC8+XG4gICAgICAgIDxTYXlDb21wb3NlciBzcGVlY2hTeW50aGVzaXM9e3NwZWVjaFN5bnRoZXNpc30gc3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlPXtTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2V9PlxuICAgICAgICAgIDx1bFxuICAgICAgICAgICAgYXJpYS1hdG9taWM9XCJmYWxzZVwiXG4gICAgICAgICAgICBhcmlhLWxpdmU9XCJwb2xpdGVcIlxuICAgICAgICAgICAgYXJpYS1yZWxldmFudD1cImFkZGl0aW9ucyB0ZXh0XCJcbiAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lcyhMSVNUX0NTUyArICcnLCBzdHlsZVNldC5hY3Rpdml0aWVzICsgJycpfVxuICAgICAgICAgICAgcm9sZT1cImxpc3RcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIHthY3Rpdml0eUVsZW1lbnRzLm1hcCgoeyBhY3Rpdml0eSwgZWxlbWVudCB9LCBpbmRleCkgPT4gKFxuICAgICAgICAgICAgICA8bGlcbiAgICAgICAgICAgICAgICAvKiBCZWNhdXNlIG9mIGRpZmZlcmVuY2VzIGluIGJyb3dzZXIgaW1wbGVtZW50YXRpb25zLCBhcmlhLWxhYmVsPVwiIFwiIGlzIHVzZWQgdG8gbWFrZSB0aGUgc2NyZWVuIHJlYWRlciBub3QgcmVwZWF0IHRoZSBzYW1lIHRleHQgbXVsdGlwbGUgdGltZXMgaW4gQ2hyb21lIHY3NSAqL1xuICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCIgXCJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMoc3R5bGVTZXQuYWN0aXZpdHkgKyAnJywge1xuICAgICAgICAgICAgICAgICAgLy8gSGlkZSB0aW1lc3RhbXAgaWYgc2FtZSB0aW1lc3RhbXAgZ3JvdXAgd2l0aCB0aGUgbmV4dCBhY3Rpdml0eVxuICAgICAgICAgICAgICAgICAgJ2hpZGUtdGltZXN0YW1wJzogc2FtZVRpbWVzdGFtcEdyb3VwKFxuICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eSxcbiAgICAgICAgICAgICAgICAgICAgKGFjdGl2aXR5RWxlbWVudHNbaW5kZXggKyAxXSB8fCB7fSkuYWN0aXZpdHksXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwVGltZXN0YW1wXG4gICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAga2V5PXsoYWN0aXZpdHkuY2hhbm5lbERhdGEgJiYgYWN0aXZpdHkuY2hhbm5lbERhdGEuY2xpZW50QWN0aXZpdHlJRCkgfHwgYWN0aXZpdHkuaWQgfHwgaW5kZXh9XG4gICAgICAgICAgICAgICAgcm9sZT1cImxpc3RpdGVtXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtlbGVtZW50fVxuICAgICAgICAgICAgICAgIHsvLyBUT0RPOiBbUDJdIFdlIHNob3VsZCB1c2UgY29yZS9kZWZpbml0aW9ucy9zcGVha2luZ0FjdGl2aXR5IGZvciB0aGlzIHByZWRpY2F0ZSBpbnN0ZWFkXG4gICAgICAgICAgICAgICAgYWN0aXZpdHkuY2hhbm5lbERhdGEgJiYgYWN0aXZpdHkuY2hhbm5lbERhdGEuc3BlYWsgJiYgPFNwZWFrQWN0aXZpdHkgYWN0aXZpdHk9e2FjdGl2aXR5fSAvPn1cbiAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgIDwvdWw+XG4gICAgICAgIDwvU2F5Q29tcG9zZXI+XG4gICAgICA8L1Njcm9sbFRvQm90dG9tUGFuZWw+XG4gICAgICB7IXN0eWxlU2V0Lm9wdGlvbnMuaGlkZVNjcm9sbFRvRW5kQnV0dG9uICYmIDxTY3JvbGxUb0VuZEJ1dHRvbiAvPn1cbiAgICA8L2Rpdj5cbiAgKTtcbn07XG5cbkJhc2ljVHJhbnNjcmlwdC5kZWZhdWx0UHJvcHMgPSB7XG4gIGNsYXNzTmFtZTogJycsXG4gIGdyb3VwVGltZXN0YW1wOiB0cnVlLFxuICB3ZWJTcGVlY2hQb255ZmlsbDogdW5kZWZpbmVkXG59O1xuXG5CYXNpY1RyYW5zY3JpcHQucHJvcFR5cGVzID0ge1xuICBhY3Rpdml0aWVzOiBQcm9wVHlwZXMuYXJyYXkuaXNSZXF1aXJlZCxcbiAgYWN0aXZpdHlSZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgYXR0YWNobWVudFJlbmRlcmVyOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBjbGFzc05hbWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGdyb3VwVGltZXN0YW1wOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLCBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWRdKSxcbiAgc3R5bGVTZXQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgYWN0aXZpdGllczogUHJvcFR5cGVzLmFueS5pc1JlcXVpcmVkLFxuICAgIGFjdGl2aXR5OiBQcm9wVHlwZXMuYW55LmlzUmVxdWlyZWQsXG4gICAgb3B0aW9uczogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgIGhpZGVTY3JvbGxUb0VuZEJ1dHRvbjogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZFxuICAgIH0pLmlzUmVxdWlyZWRcbiAgfSkuaXNSZXF1aXJlZCxcbiAgd2ViU3BlZWNoUG9ueWZpbGw6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgc3BlZWNoU3ludGhlc2lzOiBQcm9wVHlwZXMuYW55LmlzUmVxdWlyZWQsXG4gICAgU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlOiBQcm9wVHlwZXMuYW55LmlzUmVxdWlyZWRcbiAgfSlcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3RUb1dlYkNoYXQoXG4gICh7IGFjdGl2aXRpZXMsIGFjdGl2aXR5UmVuZGVyZXIsIGF0dGFjaG1lbnRSZW5kZXJlciwgZ3JvdXBUaW1lc3RhbXAsIHN0eWxlU2V0LCB3ZWJTcGVlY2hQb255ZmlsbCB9KSA9PiAoe1xuICAgIGFjdGl2aXRpZXMsXG4gICAgYWN0aXZpdHlSZW5kZXJlcixcbiAgICBhdHRhY2htZW50UmVuZGVyZXIsXG4gICAgZ3JvdXBUaW1lc3RhbXAsXG4gICAgc3R5bGVTZXQsXG4gICAgd2ViU3BlZWNoUG9ueWZpbGxcbiAgfSlcbikoQmFzaWNUcmFuc2NyaXB0KTtcbiJdfQ==
