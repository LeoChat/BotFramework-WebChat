'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.default = createStyleSet;

var _Activities = _interopRequireDefault(require('./StyleSet/Activities'));

var _Activity = _interopRequireDefault(require('./StyleSet/Activity'));

var _AudioAttachment = _interopRequireDefault(require('./StyleSet/AudioAttachment'));

var _AudioContent = _interopRequireDefault(require('./StyleSet/AudioContent'));

var _Avatar = _interopRequireDefault(require('./StyleSet/Avatar'));

var _Bubble = _interopRequireDefault(require('./StyleSet/Bubble'));

var _CarouselFilmStrip = _interopRequireDefault(require('./StyleSet/CarouselFilmStrip'));

var _CarouselFlipper = _interopRequireDefault(require('./StyleSet/CarouselFlipper'));

var _ConnectivityNotification = _interopRequireDefault(require('./StyleSet/ConnectivityNotification'));

var _DictationInterims = _interopRequireDefault(require('./StyleSet/DictationInterims'));

var _DownloadAttachment = _interopRequireDefault(require('./StyleSet/DownloadAttachment'));

var _ErrorBox = _interopRequireDefault(require('./StyleSet/ErrorBox'));

var _ErrorNotification = _interopRequireDefault(require('./StyleSet/ErrorNotification'));

var _MicrophoneButton = _interopRequireDefault(require('./StyleSet/MicrophoneButton'));

var _Root = _interopRequireDefault(require('./StyleSet/Root'));

var _ScrollToEndButton = _interopRequireDefault(require('./StyleSet/ScrollToEndButton'));

var _SendBoxButton = _interopRequireDefault(require('./StyleSet/SendBoxButton'));

var _SendBox = _interopRequireDefault(require('./StyleSet/SendBox'));

var _SendBoxTextArea = _interopRequireDefault(require('./StyleSet/SendBoxTextArea'));

var _SendBoxTextBox = _interopRequireDefault(require('./StyleSet/SendBoxTextBox'));

var _SendStatus = _interopRequireDefault(require('./StyleSet/SendStatus'));

var _SingleAttachmentActivity = _interopRequireDefault(require('./StyleSet/SingleAttachmentActivity'));

var _SpinnerAnimation = _interopRequireDefault(require('./StyleSet/SpinnerAnimation'));

var _StackedLayout = _interopRequireDefault(require('./StyleSet/StackedLayout'));

var _SuggestedActions = _interopRequireDefault(require('./StyleSet/SuggestedActions'));

var _SuggestedActionsStyleSet = _interopRequireDefault(require('./StyleSet/SuggestedActionsStyleSet'));

var _SuggestedAction = _interopRequireDefault(require('./StyleSet/SuggestedAction'));

var _TextContent = _interopRequireDefault(require('./StyleSet/TextContent'));

var _Timestamp = _interopRequireDefault(require('./StyleSet/Timestamp'));

var _TypingAnimation = _interopRequireDefault(require('./StyleSet/TypingAnimation'));

var _TypingIndicator = _interopRequireDefault(require('./StyleSet/TypingIndicator'));

var _UploadAttachment = _interopRequireDefault(require('./StyleSet/UploadAttachment'));

var _UploadButton = _interopRequireDefault(require('./StyleSet/UploadButton'));

var _VideoAttachment = _interopRequireDefault(require('./StyleSet/VideoAttachment'));

var _VideoContent = _interopRequireDefault(require('./StyleSet/VideoContent'));

var _VimeoContent = _interopRequireDefault(require('./StyleSet/VimeoContent'));

var _WarningNotification = _interopRequireDefault(require('./StyleSet/WarningNotification'));

var _YouTubeContent = _interopRequireDefault(require('./StyleSet/YouTubeContent'));

var _defaultStyleOptions = _interopRequireDefault(require('./defaultStyleOptions'));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);
  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);
    if (enumerableOnly)
      symbols = symbols.filter(function(sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      });
    keys.push.apply(keys, symbols);
  }
  return keys;
}

function _objectSpread(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};
    if (i % 2) {
      ownKeys(source, true).forEach(function(key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(source).forEach(function(key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }
  return target;
}

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });
  } else {
    obj[key] = value;
  }
  return obj;
}

// TODO: [P4] We should add a notice for people who want to use "styleSet" instead of "styleOptions".
//       "styleSet" is actually CSS stylesheet and it is based on the DOM tree.
//       DOM tree may change from time to time, thus, maintaining "styleSet" becomes a constant effort.
function parseBorder(border) {
  var dummyElement = document.createElement('div');
  dummyElement.setAttribute('style', 'border: '.concat(border));
  var _dummyElement$style = dummyElement.style,
    color = _dummyElement$style.borderColor,
    style = _dummyElement$style.borderStyle,
    width = _dummyElement$style.borderWidth;
  return {
    color: color,
    style: style,
    width: width
  };
}

var PIXEL_UNIT_PATTERN = /^[0-9]+px$/;

function createStyleSet(options) {
  options = _objectSpread({}, _defaultStyleOptions.default, {}, options); // Keep this list flat (no nested style) and serializable (no functions)
  // TODO: [P4] Deprecate this code after bump to v5

  var _options = options,
    bubbleBorder = _options.bubbleBorder,
    bubbleFromUserBorder = _options.bubbleFromUserBorder,
    bubbleFromUserNubOffset = _options.bubbleFromUserNubOffset,
    bubbleNubOffset = _options.bubbleNubOffset,
    suggestedActionBorder = _options.suggestedActionBorder,
    suggestedActionDisabledBorder = _options.suggestedActionDisabledBorder;

  if (bubbleBorder) {
    console.warn(
      'Web Chat: styleSet.bubbleBorder is being deprecated. Please use bubbleBorderColor, bubbleBorderStyle, and, bubbleBorderWidth.'
    );

    var _parseBorder = parseBorder(bubbleBorder),
      color = _parseBorder.color,
      style = _parseBorder.style,
      width = _parseBorder.width;

    if (color && color !== 'initial') {
      options.bubbleBorderColor = color;
    }

    if (style && style !== 'initial') {
      options.bubbleBorderStyle = style;
    }

    if (PIXEL_UNIT_PATTERN.test(width)) {
      options.bubbleBorderWidth = parseInt(width, 10);
    }
  }

  if (bubbleFromUserBorder) {
    console.warn(
      'Web Chat: styleSet.bubbleFromUserBorder is being deprecated. Please use bubbleFromUserBorderColor, bubbleFromUserBorderStyle, and, bubbleFromUserBorderWidth.'
    );

    var _parseBorder2 = parseBorder(bubbleFromUserBorder),
      _color = _parseBorder2.color,
      _style = _parseBorder2.style,
      _width = _parseBorder2.width;

    if (_color && _color !== 'initial') {
      options.bubbleFromUserBorderColor = _color;
    }

    if (_style && _style !== 'initial') {
      options.bubbleFromUserBorderStyle = _style;
    }

    if (PIXEL_UNIT_PATTERN.test(_width)) {
      options.bubbleFromUserBorderWidth = parseInt(_width, 10);
    }
  }

  if (suggestedActionBorder) {
    console.warn(
      'Web Chat: styleSet.suggestedActionBorder is being deprecated. Please use suggestedActionBorderColor, suggestedActionBorderStyle, and, suggestedActionBorderWidth.'
    );

    var _parseBorder3 = parseBorder(suggestedActionBorder),
      _color2 = _parseBorder3.color,
      _style2 = _parseBorder3.style,
      _width2 = _parseBorder3.width;

    if (_color2 && _color2 !== 'initial') {
      options.suggestedActionBorderColor = _color2;
    }

    if (_style2 && _style2 !== 'initial') {
      options.suggestedActionBorderStyle = _style2;
    }

    if (PIXEL_UNIT_PATTERN.test(_width2)) {
      options.suggestedActionBorderWidth = parseInt(_width2, 10);
    }
  }

  if (suggestedActionDisabledBorder) {
    console.warn(
      'Web Chat: styleSet.suggestedActionDisabledBorder is being deprecated. Please use suggestedActionDisabledBorderColor, suggestedActionDisabledBorderStyle, and, suggestedActionDisabledBorderWidth.'
    );

    var _parseBorder4 = parseBorder(suggestedActionDisabledBorder),
      _color3 = _parseBorder4.color,
      _style3 = _parseBorder4.style,
      _width3 = _parseBorder4.width;

    if (_color3 && _color3 !== 'initial') {
      options.suggestedActionDisabledBorderColor = _color3;
    }

    if (_style3 && _style3 !== 'initial') {
      options.suggestedActionDisabledBorderStyle = _style3;
    }

    if (PIXEL_UNIT_PATTERN.test(_width3)) {
      options.suggestedActionDisabledBorderWidth = parseInt(_width3, 10);
    }
  }

  if (bubbleFromUserNubOffset === 'top') {
    options.bubbleFromUserNubOffset = 0;
  } else if (typeof bubbleFromUserNubOffset !== 'number') {
    options.bubbleFromUserNubOffset = -0;
  }

  if (bubbleNubOffset === 'top') {
    options.bubbleNubOffset = 0;
  } else if (typeof bubbleNubOffset !== 'number') {
    options.bubbleNubOffset = -0;
  }

  return {
    activities: (0, _Activities.default)(options),
    activity: (0, _Activity.default)(options),
    audioAttachment: (0, _AudioAttachment.default)(options),
    audioContent: (0, _AudioContent.default)(options),
    avatar: (0, _Avatar.default)(options),
    bubble: (0, _Bubble.default)(options),
    carouselFilmStrip: (0, _CarouselFilmStrip.default)(options),
    carouselFlipper: (0, _CarouselFlipper.default)(options),
    connectivityNotification: (0, _ConnectivityNotification.default)(options),
    dictationInterims: (0, _DictationInterims.default)(options),
    downloadAttachment: (0, _DownloadAttachment.default)(options),
    errorBox: (0, _ErrorBox.default)(options),
    errorNotification: (0, _ErrorNotification.default)(options),
    microphoneButton: (0, _MicrophoneButton.default)(options),
    options: _objectSpread({}, options, {
      suggestedActionsStyleSet: (0, _SuggestedActionsStyleSet.default)(options)
    }),
    root: (0, _Root.default)(options),
    scrollToEndButton: (0, _ScrollToEndButton.default)(options),
    sendBox: (0, _SendBox.default)(options),
    sendBoxButton: (0, _SendBoxButton.default)(options),
    sendBoxTextArea: (0, _SendBoxTextArea.default)(options),
    sendBoxTextBox: (0, _SendBoxTextBox.default)(options),
    sendStatus: (0, _SendStatus.default)(options),
    singleAttachmentActivity: (0, _SingleAttachmentActivity.default)(options),
    spinnerAnimation: (0, _SpinnerAnimation.default)(options),
    stackedLayout: (0, _StackedLayout.default)(options),
    suggestedAction: (0, _SuggestedAction.default)(options),
    suggestedActions: (0, _SuggestedActions.default)(options),
    textContent: (0, _TextContent.default)(options),
    timestamp: (0, _Timestamp.default)(options),
    typingAnimation: (0, _TypingAnimation.default)(options),
    typingIndicator: (0, _TypingIndicator.default)(options),
    uploadAttachment: (0, _UploadAttachment.default)(options),
    uploadButton: (0, _UploadButton.default)(options),
    videoAttachment: (0, _VideoAttachment.default)(options),
    videoContent: (0, _VideoContent.default)(options),
    vimeoContent: (0, _VimeoContent.default)(options),
    warningNotification: (0, _WarningNotification.default)(options),
    youTubeContent: (0, _YouTubeContent.default)(options)
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9TdHlsZXMvY3JlYXRlU3R5bGVTZXQuanMiXSwibmFtZXMiOlsicGFyc2VCb3JkZXIiLCJib3JkZXIiLCJkdW1teUVsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJzdHlsZSIsImNvbG9yIiwiYm9yZGVyQ29sb3IiLCJib3JkZXJTdHlsZSIsIndpZHRoIiwiYm9yZGVyV2lkdGgiLCJQSVhFTF9VTklUX1BBVFRFUk4iLCJjcmVhdGVTdHlsZVNldCIsIm9wdGlvbnMiLCJkZWZhdWx0U3R5bGVPcHRpb25zIiwiYnViYmxlQm9yZGVyIiwiYnViYmxlRnJvbVVzZXJCb3JkZXIiLCJidWJibGVGcm9tVXNlck51Yk9mZnNldCIsImJ1YmJsZU51Yk9mZnNldCIsInN1Z2dlc3RlZEFjdGlvbkJvcmRlciIsInN1Z2dlc3RlZEFjdGlvbkRpc2FibGVkQm9yZGVyIiwiY29uc29sZSIsIndhcm4iLCJidWJibGVCb3JkZXJDb2xvciIsImJ1YmJsZUJvcmRlclN0eWxlIiwidGVzdCIsImJ1YmJsZUJvcmRlcldpZHRoIiwicGFyc2VJbnQiLCJidWJibGVGcm9tVXNlckJvcmRlckNvbG9yIiwiYnViYmxlRnJvbVVzZXJCb3JkZXJTdHlsZSIsImJ1YmJsZUZyb21Vc2VyQm9yZGVyV2lkdGgiLCJzdWdnZXN0ZWRBY3Rpb25Cb3JkZXJDb2xvciIsInN1Z2dlc3RlZEFjdGlvbkJvcmRlclN0eWxlIiwic3VnZ2VzdGVkQWN0aW9uQm9yZGVyV2lkdGgiLCJzdWdnZXN0ZWRBY3Rpb25EaXNhYmxlZEJvcmRlckNvbG9yIiwic3VnZ2VzdGVkQWN0aW9uRGlzYWJsZWRCb3JkZXJTdHlsZSIsInN1Z2dlc3RlZEFjdGlvbkRpc2FibGVkQm9yZGVyV2lkdGgiLCJhY3Rpdml0aWVzIiwiYWN0aXZpdHkiLCJhdWRpb0F0dGFjaG1lbnQiLCJhdWRpb0NvbnRlbnQiLCJhdmF0YXIiLCJidWJibGUiLCJjYXJvdXNlbEZpbG1TdHJpcCIsImNhcm91c2VsRmxpcHBlciIsImNvbm5lY3Rpdml0eU5vdGlmaWNhdGlvbiIsImRpY3RhdGlvbkludGVyaW1zIiwiZG93bmxvYWRBdHRhY2htZW50IiwiZXJyb3JCb3giLCJlcnJvck5vdGlmaWNhdGlvbiIsIm1pY3JvcGhvbmVCdXR0b24iLCJzdWdnZXN0ZWRBY3Rpb25zU3R5bGVTZXQiLCJyb290Iiwic2Nyb2xsVG9FbmRCdXR0b24iLCJzZW5kQm94Iiwic2VuZEJveEJ1dHRvbiIsInNlbmRCb3hUZXh0QXJlYSIsInNlbmRCb3hUZXh0Qm94Iiwic2VuZFN0YXR1cyIsInNpbmdsZUF0dGFjaG1lbnRBY3Rpdml0eSIsInNwaW5uZXJBbmltYXRpb24iLCJzdGFja2VkTGF5b3V0Iiwic3VnZ2VzdGVkQWN0aW9uIiwic3VnZ2VzdGVkQWN0aW9ucyIsInRleHRDb250ZW50IiwidGltZXN0YW1wIiwidHlwaW5nQW5pbWF0aW9uIiwidHlwaW5nSW5kaWNhdG9yIiwidXBsb2FkQXR0YWNobWVudCIsInVwbG9hZEJ1dHRvbiIsInZpZGVvQXR0YWNobWVudCIsInZpZGVvQ29udGVudCIsInZpbWVvQ29udGVudCIsIndhcm5pbmdOb3RpZmljYXRpb24iLCJ5b3VUdWJlQ29udGVudCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOzs7Ozs7Ozs7O0FBRUE7QUFDQTtBQUNBO0FBRUEsU0FBU0EsV0FBVCxDQUFxQkMsTUFBckIsRUFBNkI7QUFDM0IsTUFBTUMsWUFBWSxHQUFHQyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIs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bENaO0FBbUNMdUQsSUFBQUEsZ0JBQWdCLEVBQUUsK0JBQTRCdkQsT0FBNUIsQ0FuQ2I7QUFvQ0x3RCxJQUFBQSxZQUFZLEVBQUUsMkJBQXdCeEQsT0FBeEIsQ0FwQ1Q7QUFxQ0x5RCxJQUFBQSxlQUFlLEVBQUUsOEJBQTJCekQsT0FBM0IsQ0FyQ1o7QUFzQ0wwRCxJQUFBQSxZQUFZLEVBQUUsMkJBQXdCMUQsT0FBeEIsQ0F0Q1Q7QUF1Q0wyRCxJQUFBQSxZQUFZLEVBQUUsMkJBQXdCM0QsT0FBeEIsQ0F2Q1Q7QUF3Q0w0RCxJQUFBQSxtQkFBbUIsRUFBRSxrQ0FBK0I1RCxPQUEvQixDQXhDaEI7QUF5Q0w2RCxJQUFBQSxjQUFjLEVBQUUsNkJBQTBCN0QsT0FBMUI7QUF6Q1gsR0FBUDtBQTJDRCIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIGNvbXBsZXhpdHkgKi9cbmltcG9ydCBjcmVhdGVBY3Rpdml0aWVzU3R5bGUgZnJvbSAnLi9TdHlsZVNldC9BY3Rpdml0aWVzJztcbmltcG9ydCBjcmVhdGVBY3Rpdml0eVN0eWxlIGZyb20gJy4vU3R5bGVTZXQvQWN0aXZpdHknO1xuaW1wb3J0IGNyZWF0ZUF1ZGlvQXR0YWNobWVudFN0eWxlIGZyb20gJy4vU3R5bGVTZXQvQXVkaW9BdHRhY2htZW50JztcbmltcG9ydCBjcmVhdGVBdWRpb0NvbnRlbnRTdHlsZSBmcm9tICcuL1N0eWxlU2V0L0F1ZGlvQ29udGVudCc7XG5pbXBvcnQgY3JlYXRlQXZhdGFyU3R5bGUgZnJvbSAnLi9TdHlsZVNldC9BdmF0YXInO1xuaW1wb3J0IGNyZWF0ZUJ1YmJsZVN0eWxlIGZyb20gJy4vU3R5bGVTZXQvQnViYmxlJztcbmltcG9ydCBjcmVhdGVDYXJvdXNlbEZpbG1TdHJpcCBmcm9tICcuL1N0eWxlU2V0L0Nhcm91c2VsRmlsbVN0cmlwJztcbmltcG9ydCBjcmVhdGVDYXJvdXNlbEZsaXBwZXIgZnJvbSAnLi9TdHlsZVNldC9DYXJvdXNlbEZsaXBwZXInO1xuaW1wb3J0IGNyZWF0ZUNvbm5lY3Rpdml0eU5vdGlmaWNhdGlvbiBmcm9tICcuL1N0eWxlU2V0L0Nvbm5lY3Rpdml0eU5vdGlmaWNhdGlvbic7XG5pbXBvcnQgY3JlYXRlRGljdGF0aW9uSW50ZXJpbXNTdHlsZSBmcm9tICcuL1N0eWxlU2V0L0RpY3RhdGlvbkludGVyaW1zJztcbmltcG9ydCBjcmVhdGVEb3dubG9hZEF0dGFjaG1lbnRTdHlsZSBmcm9tICcuL1N0eWxlU2V0L0Rvd25sb2FkQXR0YWNobWVudCc7XG5pbXBvcnQgY3JlYXRlRXJyb3JCb3hTdHlsZSBmcm9tICcuL1N0eWxlU2V0L0Vycm9yQm94JztcbmltcG9ydCBjcmVhdGVFcnJvck5vdGlmaWNhdGlvblN0eWxlIGZyb20gJy4vU3R5bGVTZXQvRXJyb3JOb3RpZmljYXRpb24nO1xuaW1wb3J0IGNyZWF0ZU1pY3JvcGhvbmVCdXR0b25TdHlsZSBmcm9tICcuL1N0eWxlU2V0L01pY3JvcGhvbmVCdXR0b24nO1xuaW1wb3J0IGNyZWF0ZVJvb3RTdHlsZSBmcm9tICcuL1N0eWxlU2V0L1Jvb3QnO1xuaW1wb3J0IGNyZWF0ZVNjcm9sbFRvRW5kQnV0dG9uU3R5bGUgZnJvbSAnLi9TdHlsZVNldC9TY3JvbGxUb0VuZEJ1dHRvbic7XG5pbXBvcnQgY3JlYXRlU2VuZEJveEJ1dHRvblN0eWxlIGZyb20gJy4vU3R5bGVTZXQvU2VuZEJveEJ1dHRvbic7XG5pbXBvcnQgY3JlYXRlU2VuZEJveFN0eWxlIGZyb20gJy4vU3R5bGVTZXQvU2VuZEJveCc7XG5pbXBvcnQgY3JlYXRlU2VuZEJveFRleHRBcmVhU3R5bGUgZnJvbSAnLi9TdHlsZVNldC9TZW5kQm94VGV4dEFyZWEnO1xuaW1wb3J0IGNyZWF0ZVNlbmRCb3hUZXh0Qm94U3R5bGUgZnJvbSAnLi9TdHlsZVNldC9TZW5kQm94VGV4dEJveCc7XG5pbXBvcnQgY3JlYXRlU2VuZFN0YXR1c1N0eWxlIGZyb20gJy4vU3R5bGVTZXQvU2VuZFN0YXR1cyc7XG5pbXBvcnQgY3JlYXRlU2luZ2xlQXR0YWNobWVudEFjdGl2aXR5U3R5bGUgZnJvbSAnLi9TdHlsZVNldC9TaW5nbGVBdHRhY2htZW50QWN0aXZpdHknO1xuaW1wb3J0IGNyZWF0ZVNwaW5uZXJBbmltYXRpb25TdHlsZSBmcm9tICcuL1N0eWxlU2V0L1NwaW5uZXJBbmltYXRpb24nO1xuaW1wb3J0IGNyZWF0ZVN0YWNrZWRMYXlvdXRTdHlsZSBmcm9tICcuL1N0eWxlU2V0L1N0YWNrZWRMYXlvdXQnO1xuaW1wb3J0IGNyZWF0ZVN1Z2dlc3RlZEFjdGlvbnNTdHlsZSBmcm9tICcuL1N0eWxlU2V0L1N1Z2dlc3RlZEFjdGlvbnMnO1xuaW1wb3J0IGNyZWF0ZVN1Z2dlc3RlZEFjdGlvbnNTdHlsZVNldCBmcm9tICcuL1N0eWxlU2V0L1N1Z2dlc3RlZEFjdGlvbnNTdHlsZVNldCc7XG5pbXBvcnQgY3JlYXRlU3VnZ2VzdGVkQWN0aW9uU3R5bGUgZnJvbSAnLi9TdHlsZVNldC9TdWdnZXN0ZWRBY3Rpb24nO1xuaW1wb3J0IGNyZWF0ZVRleHRDb250ZW50U3R5bGUgZnJvbSAnLi9TdHlsZVNldC9UZXh0Q29udGVudCc7XG5pbXBvcnQgY3JlYXRlVGltZXN0YW1wU3R5bGUgZnJvbSAnLi9TdHlsZVNldC9UaW1lc3RhbXAnO1xuaW1wb3J0IGNyZWF0ZVR5cGluZ0FuaW1hdGlvblN0eWxlIGZyb20gJy4vU3R5bGVTZXQvVHlwaW5nQW5pbWF0aW9uJztcbmltcG9ydCBjcmVhdGVUeXBpbmdJbmRpY2F0b3JTdHlsZSBmcm9tICcuL1N0eWxlU2V0L1R5cGluZ0luZGljYXRvcic7XG5pbXBvcnQgY3JlYXRlVXBsb2FkQXR0YWNobWVudFN0eWxlIGZyb20gJy4vU3R5bGVTZXQvVXBsb2FkQXR0YWNobWVudCc7XG5pbXBvcnQgY3JlYXRlVXBsb2FkQnV0dG9uU3R5bGUgZnJvbSAnLi9TdHlsZVNldC9VcGxvYWRCdXR0b24nO1xuaW1wb3J0IGNyZWF0ZVZpZGVvQXR0YWNobWVudFN0eWxlIGZyb20gJy4vU3R5bGVTZXQvVmlkZW9BdHRhY2htZW50JztcbmltcG9ydCBjcmVhdGVWaWRlb0NvbnRlbnRTdHlsZSBmcm9tICcuL1N0eWxlU2V0L1ZpZGVvQ29udGVudCc7XG5pbXBvcnQgY3JlYXRlVmltZW9Db250ZW50U3R5bGUgZnJvbSAnLi9TdHlsZVNldC9WaW1lb0NvbnRlbnQnO1xuaW1wb3J0IGNyZWF0ZVdhcm5pbmdOb3RpZmljYXRpb25TdHlsZSBmcm9tICcuL1N0eWxlU2V0L1dhcm5pbmdOb3RpZmljYXRpb24nO1xuaW1wb3J0IGNyZWF0ZVlvdVR1YmVDb250ZW50U3R5bGUgZnJvbSAnLi9TdHlsZVNldC9Zb3VUdWJlQ29udGVudCc7XG5cbmltcG9ydCBkZWZhdWx0U3R5bGVPcHRpb25zIGZyb20gJy4vZGVmYXVsdFN0eWxlT3B0aW9ucyc7XG5cbi8vIFRPRE86IFtQNF0gV2Ugc2hvdWxkIGFkZCBhIG5vdGljZSBmb3IgcGVvcGxlIHdobyB3YW50IHRvIHVzZSBcInN0eWxlU2V0XCIgaW5zdGVhZCBvZiBcInN0eWxlT3B0aW9uc1wiLlxuLy8gICAgICAgXCJzdHlsZVNldFwiIGlzIGFjdHVhbGx5IENTUyBzdHlsZXNoZWV0IGFuZCBpdCBpcyBiYXNlZCBvbiB0aGUgRE9NIHRyZWUuXG4vLyAgICAgICBET00gdHJlZSBtYXkgY2hhbmdlIGZyb20gdGltZSB0byB0aW1lLCB0aHVzLCBtYWludGFpbmluZyBcInN0eWxlU2V0XCIgYmVjb21lcyBhIGNvbnN0YW50IGVmZm9ydC5cblxuZnVuY3Rpb24gcGFyc2VCb3JkZXIoYm9yZGVyKSB7XG4gIGNvbnN0IGR1bW15RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gIGR1bW15RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgYGJvcmRlcjogJHtib3JkZXJ9YCk7XG5cbiAgY29uc3Qge1xuICAgIHN0eWxlOiB7IGJvcmRlckNvbG9yOiBjb2xvciwgYm9yZGVyU3R5bGU6IHN0eWxlLCBib3JkZXJXaWR0aDogd2lkdGggfVxuICB9ID0gZHVtbXlFbGVtZW50O1xuXG4gIHJldHVybiB7XG4gICAgY29sb3IsXG4gICAgc3R5bGUsXG4gICAgd2lkdGhcbiAgfTtcbn1cblxuY29uc3QgUElYRUxfVU5JVF9QQVRURVJOID0gL15cXGQrcHgkL3U7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZVN0eWxlU2V0KG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IHsgLi4uZGVmYXVsdFN0eWxlT3B0aW9ucywgLi4ub3B0aW9ucyB9O1xuXG4gIC8vIEtlZXAgdGhpcyBsaXN0IGZsYXQgKG5vIG5lc3RlZCBzdHlsZSkgYW5kIHNlcmlhbGl6YWJsZSAobm8gZnVuY3Rpb25zKVxuXG4gIC8vIFRPRE86IFtQNF0gRGVwcmVjYXRlIHRoaXMgY29kZSBhZnRlciBidW1wIHRvIHY1XG4gIGNvbnN0IHtcbiAgICBidWJibGVCb3JkZXIsXG4gICAgYnViYmxlRnJvbVVzZXJCb3JkZXIsXG4gICAgYnViYmxlRnJvbVVzZXJOdWJPZmZzZXQsXG4gICAgYnViYmxlTnViT2Zmc2V0LFxuICAgIHN1Z2dlc3RlZEFjdGlvbkJvcmRlcixcbiAgICBzdWdnZXN0ZWRBY3Rpb25EaXNhYmxlZEJvcmRlclxuICB9ID0gb3B0aW9ucztcblxuICBpZiAoYnViYmxlQm9yZGVyKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgJ1dlYiBDaGF0OiBzdHlsZVNldC5idWJibGVCb3JkZXIgaXMgYmVpbmcgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSBidWJibGVCb3JkZXJDb2xvciwgYnViYmxlQm9yZGVyU3R5bGUsIGFuZCwgYnViYmxlQm9yZGVyV2lkdGguJ1xuICAgICk7XG5cbiAgICBjb25zdCB7IGNvbG9yLCBzdHlsZSwgd2lkdGggfSA9IHBhcnNlQm9yZGVyKGJ1YmJsZUJvcmRlcik7XG5cbiAgICBpZiAoY29sb3IgJiYgY29sb3IgIT09ICdpbml0aWFsJykge1xuICAgICAgb3B0aW9ucy5idWJibGVCb3JkZXJDb2xvciA9IGNvbG9yO1xuICAgIH1cblxuICAgIGlmIChzdHlsZSAmJiBzdHlsZSAhPT0gJ2luaXRpYWwnKSB7XG4gICAgICBvcHRpb25zLmJ1YmJsZUJvcmRlclN0eWxlID0gc3R5bGU7XG4gICAgfVxuXG4gICAgaWYgKFBJWEVMX1VOSVRfUEFUVEVSTi50ZXN0KHdpZHRoKSkge1xuICAgICAgb3B0aW9ucy5idWJibGVCb3JkZXJXaWR0aCA9IHBhcnNlSW50KHdpZHRoLCAxMCk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGJ1YmJsZUZyb21Vc2VyQm9yZGVyKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgJ1dlYiBDaGF0OiBzdHlsZVNldC5idWJibGVGcm9tVXNlckJvcmRlciBpcyBiZWluZyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIGJ1YmJsZUZyb21Vc2VyQm9yZGVyQ29sb3IsIGJ1YmJsZUZyb21Vc2VyQm9yZGVyU3R5bGUsIGFuZCwgYnViYmxlRnJvbVVzZXJCb3JkZXJXaWR0aC4nXG4gICAgKTtcblxuICAgIGNvbnN0IHsgY29sb3IsIHN0eWxlLCB3aWR0aCB9ID0gcGFyc2VCb3JkZXIoYnViYmxlRnJvbVVzZXJCb3JkZXIpO1xuXG4gICAgaWYgKGNvbG9yICYmIGNvbG9yICE9PSAnaW5pdGlhbCcpIHtcbiAgICAgIG9wdGlvbnMuYnViYmxlRnJvbVVzZXJCb3JkZXJDb2xvciA9IGNvbG9yO1xuICAgIH1cblxuICAgIGlmIChzdHlsZSAmJiBzdHlsZSAhPT0gJ2luaXRpYWwnKSB7XG4gICAgICBvcHRpb25zLmJ1YmJsZUZyb21Vc2VyQm9yZGVyU3R5bGUgPSBzdHlsZTtcbiAgICB9XG5cbiAgICBpZiAoUElYRUxfVU5JVF9QQVRURVJOLnRlc3Qod2lkdGgpKSB7XG4gICAgICBvcHRpb25zLmJ1YmJsZUZyb21Vc2VyQm9yZGVyV2lkdGggPSBwYXJzZUludCh3aWR0aCwgMTApO1xuICAgIH1cbiAgfVxuXG4gIGlmIChzdWdnZXN0ZWRBY3Rpb25Cb3JkZXIpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICAnV2ViIENoYXQ6IHN0eWxlU2V0LnN1Z2dlc3RlZEFjdGlvbkJvcmRlciBpcyBiZWluZyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIHN1Z2dlc3RlZEFjdGlvbkJvcmRlckNvbG9yLCBzdWdnZXN0ZWRBY3Rpb25Cb3JkZXJTdHlsZSwgYW5kLCBzdWdnZXN0ZWRBY3Rpb25Cb3JkZXJXaWR0aC4nXG4gICAgKTtcblxuICAgIGNvbnN0IHsgY29sb3IsIHN0eWxlLCB3aWR0aCB9ID0gcGFyc2VCb3JkZXIoc3VnZ2VzdGVkQWN0aW9uQm9yZGVyKTtcblxuICAgIGlmIChjb2xvciAmJiBjb2xvciAhPT0gJ2luaXRpYWwnKSB7XG4gICAgICBvcHRpb25zLnN1Z2dlc3RlZEFjdGlvbkJvcmRlckNvbG9yID0gY29sb3I7XG4gICAgfVxuXG4gICAgaWYgKHN0eWxlICYmIHN0eWxlICE9PSAnaW5pdGlhbCcpIHtcbiAgICAgIG9wdGlvbnMuc3VnZ2VzdGVkQWN0aW9uQm9yZGVyU3R5bGUgPSBzdHlsZTtcbiAgICB9XG5cbiAgICBpZiAoUElYRUxfVU5JVF9QQVRURVJOLnRlc3Qod2lkdGgpKSB7XG4gICAgICBvcHRpb25zLnN1Z2dlc3RlZEFjdGlvbkJvcmRlcldpZHRoID0gcGFyc2VJbnQod2lkdGgsIDEwKTtcbiAgICB9XG4gIH1cblxuICBpZiAoc3VnZ2VzdGVkQWN0aW9uRGlzYWJsZWRCb3JkZXIpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICAnV2ViIENoYXQ6IHN0eWxlU2V0LnN1Z2dlc3RlZEFjdGlvbkRpc2FibGVkQm9yZGVyIGlzIGJlaW5nIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2Ugc3VnZ2VzdGVkQWN0aW9uRGlzYWJsZWRCb3JkZXJDb2xvciwgc3VnZ2VzdGVkQWN0aW9uRGlzYWJsZWRCb3JkZXJTdHlsZSwgYW5kLCBzdWdnZXN0ZWRBY3Rpb25EaXNhYmxlZEJvcmRlcldpZHRoLidcbiAgICApO1xuXG4gICAgY29uc3QgeyBjb2xvciwgc3R5bGUsIHdpZHRoIH0gPSBwYXJzZUJvcmRlcihzdWdnZXN0ZWRBY3Rpb25EaXNhYmxlZEJvcmRlcik7XG5cbiAgICBpZiAoY29sb3IgJiYgY29sb3IgIT09ICdpbml0aWFsJykge1xuICAgICAgb3B0aW9ucy5zdWdnZXN0ZWRBY3Rpb25EaXNhYmxlZEJvcmRlckNvbG9yID0gY29sb3I7XG4gICAgfVxuXG4gICAgaWYgKHN0eWxlICYmIHN0eWxlICE9PSAnaW5pdGlhbCcpIHtcbiAgICAgIG9wdGlvbnMuc3VnZ2VzdGVkQWN0aW9uRGlzYWJsZWRCb3JkZXJTdHlsZSA9IHN0eWxlO1xuICAgIH1cblxuICAgIGlmIChQSVhFTF9VTklUX1BBVFRFUk4udGVzdCh3aWR0aCkpIHtcbiAgICAgIG9wdGlvbnMuc3VnZ2VzdGVkQWN0aW9uRGlzYWJsZWRCb3JkZXJXaWR0aCA9IHBhcnNlSW50KHdpZHRoLCAxMCk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGJ1YmJsZUZyb21Vc2VyTnViT2Zmc2V0ID09PSAndG9wJykge1xuICAgIG9wdGlvbnMuYnViYmxlRnJvbVVzZXJOdWJPZmZzZXQgPSAwO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBidWJibGVGcm9tVXNlck51Yk9mZnNldCAhPT0gJ251bWJlcicpIHtcbiAgICBvcHRpb25zLmJ1YmJsZUZyb21Vc2VyTnViT2Zmc2V0ID0gLTA7XG4gIH1cblxuICBpZiAoYnViYmxlTnViT2Zmc2V0ID09PSAndG9wJykge1xuICAgIG9wdGlvbnMuYnViYmxlTnViT2Zmc2V0ID0gMDtcbiAgfSBlbHNlIGlmICh0eXBlb2YgYnViYmxlTnViT2Zmc2V0ICE9PSAnbnVtYmVyJykge1xuICAgIG9wdGlvbnMuYnViYmxlTnViT2Zmc2V0ID0gLTA7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGFjdGl2aXRpZXM6IGNyZWF0ZUFjdGl2aXRpZXNTdHlsZShvcHRpb25zKSxcbiAgICBhY3Rpdml0eTogY3JlYXRlQWN0aXZpdHlTdHlsZShvcHRpb25zKSxcbiAgICBhdWRpb0F0dGFjaG1lbnQ6IGNyZWF0ZUF1ZGlvQXR0YWNobWVudFN0eWxlKG9wdGlvbnMpLFxuICAgIGF1ZGlvQ29udGVudDogY3JlYXRlQXVkaW9Db250ZW50U3R5bGUob3B0aW9ucyksXG4gICAgYXZhdGFyOiBjcmVhdGVBdmF0YXJTdHlsZShvcHRpb25zKSxcbiAgICBidWJibGU6IGNyZWF0ZUJ1YmJsZVN0eWxlKG9wdGlvbnMpLFxuICAgIGNhcm91c2VsRmlsbVN0cmlwOiBjcmVhdGVDYXJvdXNlbEZpbG1TdHJpcChvcHRpb25zKSxcbiAgICBjYXJvdXNlbEZsaXBwZXI6IGNyZWF0ZUNhcm91c2VsRmxpcHBlcihvcHRpb25zKSxcbiAgICBjb25uZWN0aXZpdHlOb3RpZmljYXRpb246IGNyZWF0ZUNvbm5lY3Rpdml0eU5vdGlmaWNhdGlvbihvcHRpb25zKSxcbiAgICBkaWN0YXRpb25JbnRlcmltczogY3JlYXRlRGljdGF0aW9uSW50ZXJpbXNTdHlsZShvcHRpb25zKSxcbiAgICBkb3dubG9hZEF0dGFjaG1lbnQ6IGNyZWF0ZURvd25sb2FkQXR0YWNobWVudFN0eWxlKG9wdGlvbnMpLFxuICAgIGVycm9yQm94OiBjcmVhdGVFcnJvckJveFN0eWxlKG9wdGlvbnMpLFxuICAgIGVycm9yTm90aWZpY2F0aW9uOiBjcmVhdGVFcnJvck5vdGlmaWNhdGlvblN0eWxlKG9wdGlvbnMpLFxuICAgIG1pY3JvcGhvbmVCdXR0b246IGNyZWF0ZU1pY3JvcGhvbmVCdXR0b25TdHlsZShvcHRpb25zKSxcbiAgICBvcHRpb25zOiB7XG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgc3VnZ2VzdGVkQWN0aW9uc1N0eWxlU2V0OiBjcmVhdGVTdWdnZXN0ZWRBY3Rpb25zU3R5bGVTZXQob3B0aW9ucylcbiAgICB9LFxuICAgIHJvb3Q6IGNyZWF0ZVJvb3RTdHlsZShvcHRpb25zKSxcbiAgICBzY3JvbGxUb0VuZEJ1dHRvbjogY3JlYXRlU2Nyb2xsVG9FbmRCdXR0b25TdHlsZShvcHRpb25zKSxcbiAgICBzZW5kQm94OiBjcmVhdGVTZW5kQm94U3R5bGUob3B0aW9ucyksXG4gICAgc2VuZEJveEJ1dHRvbjogY3JlYXRlU2VuZEJveEJ1dHRvblN0eWxlKG9wdGlvbnMpLFxuICAgIHNlbmRCb3hUZXh0QXJlYTogY3JlYXRlU2VuZEJveFRleHRBcmVhU3R5bGUob3B0aW9ucyksXG4gICAgc2VuZEJveFRleHRCb3g6IGNyZWF0ZVNlbmRCb3hUZXh0Qm94U3R5bGUob3B0aW9ucyksXG4gICAgc2VuZFN0YXR1czogY3JlYXRlU2VuZFN0YXR1c1N0eWxlKG9wdGlvbnMpLFxuICAgIHNpbmdsZUF0dGFjaG1lbnRBY3Rpdml0eTogY3JlYXRlU2luZ2xlQXR0YWNobWVudEFjdGl2aXR5U3R5bGUob3B0aW9ucyksXG4gICAgc3Bpbm5lckFuaW1hdGlvbjogY3JlYXRlU3Bpbm5lckFuaW1hdGlvblN0eWxlKG9wdGlvbnMpLFxuICAgIHN0YWNrZWRMYXlvdXQ6IGNyZWF0ZVN0YWNrZWRMYXlvdXRTdHlsZShvcHRpb25zKSxcbiAgICBzdWdnZXN0ZWRBY3Rpb246IGNyZWF0ZVN1Z2dlc3RlZEFjdGlvblN0eWxlKG9wdGlvbnMpLFxuICAgIHN1Z2dlc3RlZEFjdGlvbnM6IGNyZWF0ZVN1Z2dlc3RlZEFjdGlvbnNTdHlsZShvcHRpb25zKSxcbiAgICB0ZXh0Q29udGVudDogY3JlYXRlVGV4dENvbnRlbnRTdHlsZShvcHRpb25zKSxcbiAgICB0aW1lc3RhbXA6IGNyZWF0ZVRpbWVzdGFtcFN0eWxlKG9wdGlvbnMpLFxuICAgIHR5cGluZ0FuaW1hdGlvbjogY3JlYXRlVHlwaW5nQW5pbWF0aW9uU3R5bGUob3B0aW9ucyksXG4gICAgdHlwaW5nSW5kaWNhdG9yOiBjcmVhdGVUeXBpbmdJbmRpY2F0b3JTdHlsZShvcHRpb25zKSxcbiAgICB1cGxvYWRBdHRhY2htZW50OiBjcmVhdGVVcGxvYWRBdHRhY2htZW50U3R5bGUob3B0aW9ucyksXG4gICAgdXBsb2FkQnV0dG9uOiBjcmVhdGVVcGxvYWRCdXR0b25TdHlsZShvcHRpb25zKSxcbiAgICB2aWRlb0F0dGFjaG1lbnQ6IGNyZWF0ZVZpZGVvQXR0YWNobWVudFN0eWxlKG9wdGlvbnMpLFxuICAgIHZpZGVvQ29udGVudDogY3JlYXRlVmlkZW9Db250ZW50U3R5bGUob3B0aW9ucyksXG4gICAgdmltZW9Db250ZW50OiBjcmVhdGVWaW1lb0NvbnRlbnRTdHlsZShvcHRpb25zKSxcbiAgICB3YXJuaW5nTm90aWZpY2F0aW9uOiBjcmVhdGVXYXJuaW5nTm90aWZpY2F0aW9uU3R5bGUob3B0aW9ucyksXG4gICAgeW91VHViZUNvbnRlbnQ6IGNyZWF0ZVlvdVR1YmVDb250ZW50U3R5bGUob3B0aW9ucylcbiAgfTtcbn1cbiJdfQ==
