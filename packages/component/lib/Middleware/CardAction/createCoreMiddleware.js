'use strict';

var cov_2nxrae0wvn = (function() {
  var path =
    '/Users/guy/Work/Leo/leo/BotFramework-WebChat/packages/component/src/Middleware/CardAction/createCoreMiddleware.js';
  var hash = '65fd2211aff3fd8854706808b3584e289e15a231';
  var global = new Function('return this')();
  var gcv = '__coverage__';
  var coverageData = {
    path:
      '/Users/guy/Work/Leo/leo/BotFramework-WebChat/packages/component/src/Middleware/CardAction/createCoreMiddleware.js',
    statementMap: {
      '0': {
        start: {
          line: 4,
          column: 2
        },
        end: {
          line: 53,
          column: 4
        }
      },
      '1': {
        start: {
          line: 4,
          column: 27
        },
        end: {
          line: 53,
          column: 3
        }
      },
      '2': {
        start: {
          line: 4,
          column: 35
        },
        end: {
          line: 53,
          column: 3
        }
      },
      '3': {
        start: {
          line: 5,
          column: 47
        },
        end: {
          line: 5,
          column: 57
        }
      },
      '4': {
        start: {
          line: 7,
          column: 4
        },
        end: {
          line: 52,
          column: 5
        }
      },
      '5': {
        start: {
          line: 9,
          column: 8
        },
        end: {
          line: 14,
          column: 9
        }
      },
      '6': {
        start: {
          line: 11,
          column: 10
        },
        end: {
          line: 11,
          column: 49
        }
      },
      '7': {
        start: {
          line: 13,
          column: 10
        },
        end: {
          line: 13,
          column: 74
        }
      },
      '8': {
        start: {
          line: 16,
          column: 8
        },
        end: {
          line: 16,
          column: 14
        }
      },
      '9': {
        start: {
          line: 19,
          column: 8
        },
        end: {
          line: 19,
          column: 60
        }
      },
      '10': {
        start: {
          line: 21,
          column: 8
        },
        end: {
          line: 21,
          column: 14
        }
      },
      '11': {
        start: {
          line: 24,
          column: 8
        },
        end: {
          line: 24,
          column: 38
        }
      },
      '12': {
        start: {
          line: 26,
          column: 8
        },
        end: {
          line: 26,
          column: 14
        }
      },
      '13': {
        start: {
          line: 34,
          column: 8
        },
        end: {
          line: 34,
          column: 27
        }
      },
      '14': {
        start: {
          line: 35,
          column: 8
        },
        end: {
          line: 35,
          column: 14
        }
      },
      '15': {
        start: {
          line: 41,
          column: 22
        },
        end: {
          line: 41,
          column: 35
        }
      },
      '16': {
        start: {
          line: 43,
          column: 8
        },
        end: {
          line: 45,
          column: 11
        }
      },
      '17': {
        start: {
          line: 44,
          column: 10
        },
        end: {
          line: 44,
          column: 36
        }
      },
      '18': {
        start: {
          line: 47,
          column: 8
        },
        end: {
          line: 47,
          column: 14
        }
      },
      '19': {
        start: {
          line: 51,
          column: 8
        },
        end: {
          line: 51,
          column: 50
        }
      }
    },
    fnMap: {
      '0': {
        name: 'createDefaultCardActionMiddleware',
        decl: {
          start: {
            line: 3,
            column: 24
          },
          end: {
            line: 3,
            column: 57
          }
        },
        loc: {
          start: {
            line: 3,
            column: 60
          },
          end: {
            line: 54,
            column: 1
          }
        },
        line: 3
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 4,
            column: 9
          },
          end: {
            line: 4,
            column: 10
          }
        },
        loc: {
          start: {
            line: 4,
            column: 27
          },
          end: {
            line: 53,
            column: 3
          }
        },
        line: 4
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 4,
            column: 27
          },
          end: {
            line: 4,
            column: 28
          }
        },
        loc: {
          start: {
            line: 4,
            column: 35
          },
          end: {
            line: 53,
            column: 3
          }
        },
        line: 4
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 4,
            column: 35
          },
          end: {
            line: 4,
            column: 36
          }
        },
        loc: {
          start: {
            line: 4,
            column: 69
          },
          end: {
            line: 53,
            column: 3
          }
        },
        line: 4
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 43,
            column: 28
          },
          end: {
            line: 43,
            column: 29
          }
        },
        loc: {
          start: {
            line: 43,
            column: 35
          },
          end: {
            line: 45,
            column: 9
          }
        },
        line: 43
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 7,
            column: 4
          },
          end: {
            line: 52,
            column: 5
          }
        },
        type: 'switch',
        locations: [
          {
            start: {
              line: 8,
              column: 6
            },
            end: {
              line: 16,
              column: 14
            }
          },
          {
            start: {
              line: 18,
              column: 6
            },
            end: {
              line: 21,
              column: 14
            }
          },
          {
            start: {
              line: 23,
              column: 6
            },
            end: {
              line: 26,
              column: 14
            }
          },
          {
            start: {
              line: 28,
              column: 6
            },
            end: {
              line: 28,
              column: 18
            }
          },
          {
            start: {
              line: 29,
              column: 6
            },
            end: {
              line: 29,
              column: 26
            }
          },
          {
            start: {
              line: 30,
              column: 6
            },
            end: {
              line: 30,
              column: 21
            }
          },
          {
            start: {
              line: 31,
              column: 6
            },
            end: {
              line: 31,
              column: 23
            }
          },
          {
            start: {
              line: 32,
              column: 6
            },
            end: {
              line: 32,
              column: 23
            }
          },
          {
            start: {
              line: 33,
              column: 6
            },
            end: {
              line: 35,
              column: 14
            }
          },
          {
            start: {
              line: 37,
              column: 6
            },
            end: {
              line: 48,
              column: 7
            }
          },
          {
            start: {
              line: 50,
              column: 6
            },
            end: {
              line: 51,
              column: 50
            }
          }
        ],
        line: 7
      },
      '1': {
        loc: {
          start: {
            line: 9,
            column: 8
          },
          end: {
            line: 14,
            column: 9
          }
        },
        type: 'if',
        locations: [
          {
            start: {
              line: 9,
              column: 8
            },
            end: {
              line: 14,
              column: 9
            }
          },
          {
            start: {
              line: 9,
              column: 8
            },
            end: {
              line: 14,
              column: 9
            }
          }
        ],
        line: 9
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0
    },
    b: {
      '0': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      '1': [0, 0]
    },
    _coverageSchema: '43e27e138ebf9cfc5966b082cf9a028302ed4184',
    hash: '65fd2211aff3fd8854706808b3584e289e15a231'
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  return (coverage[path] = coverageData);
})();

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.default = createDefaultCardActionMiddleware;

var _botframeworkWebchatCore = require('botframework-webchat-core');

function createDefaultCardActionMiddleware() {
  cov_2nxrae0wvn.f[0]++;
  cov_2nxrae0wvn.s[0]++;
  return function(_ref) {
    var dispatch = _ref.dispatch;
    cov_2nxrae0wvn.f[1]++;
    cov_2nxrae0wvn.s[1]++;
    return function(next) {
      cov_2nxrae0wvn.f[2]++;
      cov_2nxrae0wvn.s[2]++;
      return function(_ref2) {
        var cardAction = _ref2.cardAction,
          getSignInUrl = _ref2.getSignInUrl;
        cov_2nxrae0wvn.f[3]++;

        var _ref3 = (cov_2nxrae0wvn.s[3]++, cardAction),
          displayText = _ref3.displayText,
          text = _ref3.text,
          type = _ref3.type,
          value = _ref3.value;

        cov_2nxrae0wvn.s[4]++;

        switch (type) {
          case 'imBack':
            cov_2nxrae0wvn.b[0][0]++;
            cov_2nxrae0wvn.s[5]++;

            if (typeof value === 'string') {
              cov_2nxrae0wvn.b[1][0]++;
              cov_2nxrae0wvn.s[6]++;
              // TODO: [P4] Instead of calling dispatch, we should move to dispatchers instead for completeness
              dispatch((0, _botframeworkWebchatCore.sendMessage)(value, 'imBack'));
            } else {
              cov_2nxrae0wvn.b[1][1]++;
              cov_2nxrae0wvn.s[7]++;
              throw new Error('cannot send "imBack" with a non-string value');
            }

            cov_2nxrae0wvn.s[8]++;
            break;

          case 'messageBack':
            cov_2nxrae0wvn.b[0][1]++;
            cov_2nxrae0wvn.s[9]++;
            dispatch((0, _botframeworkWebchatCore.sendMessageBack)(value, text, displayText));
            cov_2nxrae0wvn.s[10]++;
            break;

          case 'postBack':
            cov_2nxrae0wvn.b[0][2]++;
            cov_2nxrae0wvn.s[11]++;
            dispatch((0, _botframeworkWebchatCore.sendPostBack)(value));
            cov_2nxrae0wvn.s[12]++;
            break;

          case 'call':
            cov_2nxrae0wvn.b[0][3]++;

          case 'downloadFile':
            cov_2nxrae0wvn.b[0][4]++;

          case 'openUrl':
            cov_2nxrae0wvn.b[0][5]++;

          case 'playAudio':
            cov_2nxrae0wvn.b[0][6]++;

          case 'playVideo':
            cov_2nxrae0wvn.b[0][7]++;

          case 'showImage':
            cov_2nxrae0wvn.b[0][8]++;
            cov_2nxrae0wvn.s[13]++;
            window.open(value);
            cov_2nxrae0wvn.s[14]++;
            break;

          case 'signin':
            cov_2nxrae0wvn.b[0][9]++;
            {
              // TODO: [P3] We should prime the URL into the OAuthCard directly, instead of calling getSessionId on-demand
              //       This is to eliminate the delay between window.open() and location.href call
              var popup = (cov_2nxrae0wvn.s[15]++, window.open());
              cov_2nxrae0wvn.s[16]++;
              getSignInUrl().then(function(url) {
                cov_2nxrae0wvn.f[4]++;
                cov_2nxrae0wvn.s[17]++;
                popup.location.href = url;
              });
              cov_2nxrae0wvn.s[18]++;
              break;
            }

          default:
            cov_2nxrae0wvn.b[0][10]++;
            cov_2nxrae0wvn.s[19]++;
            return next({
              cardAction: cardAction,
              getSignInUrl: getSignInUrl
            });
        }
      };
    };
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9NaWRkbGV3YXJlL0NhcmRBY3Rpb24vY3JlYXRlQ29yZU1pZGRsZXdhcmUuanMiXSwibmFtZXMiOlsiY3JlYXRlRGVmYXVsdENhcmRBY3Rpb25NaWRkbGV3YXJlIiwiZGlzcGF0Y2giLCJuZXh0IiwiY2FyZEFjdGlvbiIsImdldFNpZ25JblVybCIsImRpc3BsYXlUZXh0IiwidGV4dCIsInR5cGUiLCJ2YWx1ZSIsIkVycm9yIiwid2luZG93Iiwib3BlbiIsInBvcHVwIiwidGhlbiIsInVybCIsImxvY2F0aW9uIiwiaHJlZiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUVlLFNBQVNBLGlDQUFULEdBQTZDO0FBQUE7QUFBQTtBQUMxRCxTQUFPLGdCQUFrQjtBQUFBLFFBQWZDLFFBQWUsUUFBZkEsUUFBZTtBQUFBO0FBQUE7QUFBQSxxQkFBQUMsSUFBSSxFQUFJO0FBQUE7QUFBQTtBQUFBLDhCQUFrQztBQUFBLFlBQS9CQyxVQUErQixTQUEvQkEsVUFBK0I7QUFBQSxZQUFuQkMsWUFBbUIsU0FBbkJBLFlBQW1CO0FBQUE7O0FBQUEsNENBQ3RCRCxVQURzQjtBQUFBLFlBQ3pERSxXQUR5RCxTQUN6REEsV0FEeUQ7QUFBQSxZQUM1Q0MsSUFENEMsU0FDNUNBLElBRDRDO0FBQUEsWUFDdENDLElBRHNDLFNBQ3RDQSxJQURzQztBQUFBLFlBQ2hDQyxLQURnQyxTQUNoQ0EsS0FEZ0M7O0FBQUE7O0FBR2pFLGdCQUFRRCxJQUFSO0FBQ0UsZUFBSyxRQUFMO0FBQUE7QUFBQTs7QUFDRSxnQkFBSSxPQUFPQyxLQUFQLEtBQWlCLFFBQXJCLEVBQStCO0FBQUE7QUFBQTtBQUM3QjtBQUNBUCxjQUFBQSxRQUFRLENBQUMsMENBQVlPLEtBQVosRUFBbUIsUUFBbkIsQ0FBRCxDQUFSO0FBQ0QsYUFIRCxNQUdPO0FBQUE7QUFBQTtBQUNMLG9CQUFNLElBQUlDLEtBQUosQ0FBVSw4Q0FBVixDQUFOO0FBQ0Q7O0FBTkg7QUFRRTs7QUFFRixlQUFLLGFBQUw7QUFBQTtBQUFBO0FBQ0VSLFlBQUFBLFFBQVEsQ0FBQyw4Q0FBZ0JPLEtBQWhCLEVBQXVCRixJQUF2QixFQUE2QkQsV0FBN0IsQ0FBRCxDQUFSO0FBREY7QUFHRTs7QUFFRixlQUFLLFVBQUw7QUFBQTtBQUFBO0FBQ0VKLFlBQUFBLFFBQVEsQ0FBQywyQ0FBYU8sS0FBYixDQUFELENBQVI7QUFERjtBQUdFOztBQUVGLGVBQUssTUFBTDtBQUFBOztBQUNBLGVBQUssY0FBTDtBQUFBOztBQUNBLGVBQUssU0FBTDtBQUFBOztBQUNBLGVBQUssV0FBTDtBQUFBOztBQUNBLGVBQUssV0FBTDtBQUFBOztBQUNBLGVBQUssV0FBTDtBQUFBO0FBQUE7QUFDRUUsWUFBQUEsTUFBTSxDQUFDQyxJQUFQLENBQVlILEtBQVo7QUFERjtBQUVFOztBQUVGLGVBQUssUUFBTDtBQUFBO0FBQWU7QUFDYjtBQUNBO0FBRUEsa0JBQU1JLEtBQUssNEJBQUdGLE1BQU0sQ0FBQ0MsSUFBUCxFQUFILENBQVg7QUFKYTtBQU1iUCxjQUFBQSxZQUFZLEdBQUdTLElBQWYsQ0FBb0IsVUFBQUMsR0FBRyxFQUFJO0FBQUE7QUFBQTtBQUN6QkYsZ0JBQUFBLEtBQUssQ0FBQ0csUUFBTixDQUFlQyxJQUFmLEdBQXNCRixHQUF0QjtBQUNELGVBRkQ7QUFOYTtBQVViO0FBQ0Q7O0FBRUQ7QUFBQTtBQUFBO0FBQ0UsbUJBQU9aLElBQUksQ0FBQztBQUFFQyxjQUFBQSxVQUFVLEVBQVZBLFVBQUY7QUFBY0MsY0FBQUEsWUFBWSxFQUFaQTtBQUFkLGFBQUQsQ0FBWDtBQTVDSjtBQThDRCxPQWpEZ0M7QUFpRGhDLEtBakR3QjtBQWlEeEIsR0FqREQ7QUFrREQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzZW5kTWVzc2FnZSwgc2VuZE1lc3NhZ2VCYWNrLCBzZW5kUG9zdEJhY2sgfSBmcm9tICdib3RmcmFtZXdvcmstd2ViY2hhdC1jb3JlJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdENhcmRBY3Rpb25NaWRkbGV3YXJlKCkge1xuICByZXR1cm4gKHsgZGlzcGF0Y2ggfSkgPT4gbmV4dCA9PiAoeyBjYXJkQWN0aW9uLCBnZXRTaWduSW5VcmwgfSkgPT4ge1xuICAgIGNvbnN0IHsgZGlzcGxheVRleHQsIHRleHQsIHR5cGUsIHZhbHVlIH0gPSBjYXJkQWN0aW9uO1xuXG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlICdpbUJhY2snOlxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIC8vIFRPRE86IFtQNF0gSW5zdGVhZCBvZiBjYWxsaW5nIGRpc3BhdGNoLCB3ZSBzaG91bGQgbW92ZSB0byBkaXNwYXRjaGVycyBpbnN0ZWFkIGZvciBjb21wbGV0ZW5lc3NcbiAgICAgICAgICBkaXNwYXRjaChzZW5kTWVzc2FnZSh2YWx1ZSwgJ2ltQmFjaycpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2Nhbm5vdCBzZW5kIFwiaW1CYWNrXCIgd2l0aCBhIG5vbi1zdHJpbmcgdmFsdWUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdtZXNzYWdlQmFjayc6XG4gICAgICAgIGRpc3BhdGNoKHNlbmRNZXNzYWdlQmFjayh2YWx1ZSwgdGV4dCwgZGlzcGxheVRleHQpKTtcblxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAncG9zdEJhY2snOlxuICAgICAgICBkaXNwYXRjaChzZW5kUG9zdEJhY2sodmFsdWUpKTtcblxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnY2FsbCc6XG4gICAgICBjYXNlICdkb3dubG9hZEZpbGUnOlxuICAgICAgY2FzZSAnb3BlblVybCc6XG4gICAgICBjYXNlICdwbGF5QXVkaW8nOlxuICAgICAgY2FzZSAncGxheVZpZGVvJzpcbiAgICAgIGNhc2UgJ3Nob3dJbWFnZSc6XG4gICAgICAgIHdpbmRvdy5vcGVuKHZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ3NpZ25pbic6IHtcbiAgICAgICAgLy8gVE9ETzogW1AzXSBXZSBzaG91bGQgcHJpbWUgdGhlIFVSTCBpbnRvIHRoZSBPQXV0aENhcmQgZGlyZWN0bHksIGluc3RlYWQgb2YgY2FsbGluZyBnZXRTZXNzaW9uSWQgb24tZGVtYW5kXG4gICAgICAgIC8vICAgICAgIFRoaXMgaXMgdG8gZWxpbWluYXRlIHRoZSBkZWxheSBiZXR3ZWVuIHdpbmRvdy5vcGVuKCkgYW5kIGxvY2F0aW9uLmhyZWYgY2FsbFxuXG4gICAgICAgIGNvbnN0IHBvcHVwID0gd2luZG93Lm9wZW4oKTtcblxuICAgICAgICBnZXRTaWduSW5VcmwoKS50aGVuKHVybCA9PiB7XG4gICAgICAgICAgcG9wdXAubG9jYXRpb24uaHJlZiA9IHVybDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBuZXh0KHsgY2FyZEFjdGlvbiwgZ2V0U2lnbkluVXJsIH0pO1xuICAgIH1cbiAgfTtcbn1cbiJdfQ==
