'use strict';

var cov_1gj6ssiu1r = (function() {
  var path =
    '/Users/guy/Work/Leo/leo/BotFramework-WebChat/packages/component/src/Middleware/Attachment/createCoreMiddleware.js';
  var hash = 'f5b583ebc5f4af0abb9827365ca3ef16b4fc5669';
  var global = new Function('return this')();
  var gcv = '__coverage__';
  var coverageData = {
    path:
      '/Users/guy/Work/Leo/leo/BotFramework-WebChat/packages/component/src/Middleware/Attachment/createCoreMiddleware.js',
    statementMap: {
      '0': {
        start: {
          line: 12,
          column: 26
        },
        end: {
          line: 12,
          column: 57
        }
      },
      '1': {
        start: {
          line: 14,
          column: 2
        },
        end: {
          line: 14,
          column: 49
        }
      },
      '2': {
        start: {
          line: 19,
          column: 2
        },
        end: {
          line: 51,
          column: 4
        }
      },
      '3': {
        start: {
          line: 19,
          column: 15
        },
        end: {
          line: 51,
          column: 3
        }
      },
      '4': {
        start: {
          line: 20,
          column: 23
        },
        end: {
          line: 40,
          column: 7
        }
      },
      '5': {
        start: {
          line: 26,
          column: 6
        },
        end: {
          line: 40,
          column: 7
        }
      },
      '6': {
        start: {
          line: 42,
          column: 4
        },
        end: {
          line: 48,
          column: 6
        }
      },
      '7': {
        start: {
          line: 50,
          column: 4
        },
        end: {
          line: 50,
          column: 22
        }
      }
    },
    fnMap: {
      '0': {
        name: 'hasThumbnail',
        decl: {
          start: {
            line: 11,
            column: 9
          },
          end: {
            line: 11,
            column: 21
          }
        },
        loc: {
          start: {
            line: 11,
            column: 105
          },
          end: {
            line: 15,
            column: 1
          }
        },
        line: 11
      },
      '1': {
        name: 'createCoreMiddleware',
        decl: {
          start: {
            line: 18,
            column: 24
          },
          end: {
            line: 18,
            column: 44
          }
        },
        loc: {
          start: {
            line: 18,
            column: 47
          },
          end: {
            line: 52,
            column: 1
          }
        },
        line: 18
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 19,
            column: 9
          },
          end: {
            line: 19,
            column: 10
          }
        },
        loc: {
          start: {
            line: 19,
            column: 15
          },
          end: {
            line: 51,
            column: 3
          }
        },
        line: 19
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 19,
            column: 15
          },
          end: {
            line: 19,
            column: 16
          }
        },
        loc: {
          start: {
            line: 19,
            column: 23
          },
          end: {
            line: 51,
            column: 3
          }
        },
        line: 19
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 20,
            column: 23
          },
          end: {
            line: 20,
            column: 24
          }
        },
        loc: {
          start: {
            line: 26,
            column: 6
          },
          end: {
            line: 40,
            column: 7
          }
        },
        line: 26
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 11,
            column: 24
          },
          end: {
            line: 11,
            column: 40
          }
        },
        type: 'default-arg',
        locations: [
          {
            start: {
              line: 11,
              column: 38
            },
            end: {
              line: 11,
              column: 40
            }
          }
        ],
        line: 11
      },
      '1': {
        loc: {
          start: {
            line: 11,
            column: 55
          },
          end: {
            line: 11,
            column: 89
          }
        },
        type: 'default-arg',
        locations: [
          {
            start: {
              line: 11,
              column: 87
            },
            end: {
              line: 11,
              column: 89
            }
          }
        ],
        line: 11
      },
      '2': {
        loc: {
          start: {
            line: 11,
            column: 57
          },
          end: {
            line: 11,
            column: 82
          }
        },
        type: 'default-arg',
        locations: [
          {
            start: {
              line: 11,
              column: 80
            },
            end: {
              line: 11,
              column: 82
            }
          }
        ],
        line: 11
      },
      '3': {
        loc: {
          start: {
            line: 21,
            column: 6
          },
          end: {
            line: 21,
            column: 19
          }
        },
        type: 'default-arg',
        locations: [
          {
            start: {
              line: 21,
              column: 17
            },
            end: {
              line: 21,
              column: 19
            }
          }
        ],
        line: 21
      },
      '4': {
        loc: {
          start: {
            line: 22,
            column: 16
          },
          end: {
            line: 22,
            column: 39
          }
        },
        type: 'default-arg',
        locations: [
          {
            start: {
              line: 22,
              column: 37
            },
            end: {
              line: 22,
              column: 39
            }
          }
        ],
        line: 22
      },
      '5': {
        loc: {
          start: {
            line: 24,
            column: 18
          },
          end: {
            line: 24,
            column: 50
          }
        },
        type: 'default-arg',
        locations: [
          {
            start: {
              line: 24,
              column: 48
            },
            end: {
              line: 24,
              column: 50
            }
          }
        ],
        line: 24
      },
      '6': {
        loc: {
          start: {
            line: 26,
            column: 6
          },
          end: {
            line: 40,
            column: 7
          }
        },
        type: 'cond-expr',
        locations: [
          {
            start: {
              line: 27,
              column: 8
            },
            end: {
              line: 27,
              column: 72
            }
          },
          {
            start: {
              line: 28,
              column: 10
            },
            end: {
              line: 40,
              column: 7
            }
          }
        ],
        line: 26
      },
      '7': {
        loc: {
          start: {
            line: 26,
            column: 6
          },
          end: {
            line: 26,
            column: 93
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 26,
              column: 6
            },
            end: {
              line: 26,
              column: 21
            }
          },
          {
            start: {
              line: 26,
              column: 25
            },
            end: {
              line: 26,
              column: 54
            }
          },
          {
            start: {
              line: 26,
              column: 58
            },
            end: {
              line: 26,
              column: 93
            }
          }
        ],
        line: 26
      },
      '8': {
        loc: {
          start: {
            line: 28,
            column: 10
          },
          end: {
            line: 40,
            column: 7
          }
        },
        type: 'cond-expr',
        locations: [
          {
            start: {
              line: 29,
              column: 8
            },
            end: {
              line: 29,
              column: 71
            }
          },
          {
            start: {
              line: 30,
              column: 10
            },
            end: {
              line: 40,
              column: 7
            }
          }
        ],
        line: 28
      },
      '9': {
        loc: {
          start: {
            line: 30,
            column: 10
          },
          end: {
            line: 40,
            column: 7
          }
        },
        type: 'cond-expr',
        locations: [
          {
            start: {
              line: 31,
              column: 8
            },
            end: {
              line: 31,
              column: 71
            }
          },
          {
            start: {
              line: 32,
              column: 10
            },
            end: {
              line: 40,
              column: 7
            }
          }
        ],
        line: 30
      },
      '10': {
        loc: {
          start: {
            line: 32,
            column: 10
          },
          end: {
            line: 40,
            column: 7
          }
        },
        type: 'cond-expr',
        locations: [
          {
            start: {
              line: 33,
              column: 8
            },
            end: {
              line: 33,
              column: 71
            }
          },
          {
            start: {
              line: 34,
              column: 10
            },
            end: {
              line: 40,
              column: 7
            }
          }
        ],
        line: 32
      },
      '11': {
        loc: {
          start: {
            line: 34,
            column: 10
          },
          end: {
            line: 40,
            column: 7
          }
        },
        type: 'cond-expr',
        locations: [
          {
            start: {
              line: 35,
              column: 8
            },
            end: {
              line: 35,
              column: 74
            }
          },
          {
            start: {
              line: 36,
              column: 10
            },
            end: {
              line: 40,
              column: 7
            }
          }
        ],
        line: 34
      },
      '12': {
        loc: {
          start: {
            line: 34,
            column: 10
          },
          end: {
            line: 34,
            column: 66
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 34,
              column: 10
            },
            end: {
              line: 34,
              column: 20
            }
          },
          {
            start: {
              line: 34,
              column: 24
            },
            end: {
              line: 34,
              column: 66
            }
          }
        ],
        line: 34
      },
      '13': {
        loc: {
          start: {
            line: 36,
            column: 10
          },
          end: {
            line: 40,
            column: 7
          }
        },
        type: 'cond-expr',
        locations: [
          {
            start: {
              line: 37,
              column: 8
            },
            end: {
              line: 37,
              column: 70
            }
          },
          {
            start: {
              line: 39,
              column: 8
            },
            end: {
              line: 39,
              column: 38
            }
          }
        ],
        line: 36
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0
    },
    b: {
      '0': [0],
      '1': [0],
      '2': [0],
      '3': [0],
      '4': [0],
      '5': [0],
      '6': [0, 0],
      '7': [0, 0, 0],
      '8': [0, 0],
      '9': [0, 0],
      '10': [0, 0],
      '11': [0, 0],
      '12': [0, 0],
      '13': [0, 0]
    },
    _coverageSchema: '43e27e138ebf9cfc5966b082cf9a028302ed4184',
    hash: 'f5b583ebc5f4af0abb9827365ca3ef16b4fc5669'
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  return (coverage[path] = coverageData);
})();

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.default = createCoreMiddleware;

var _propTypes = _interopRequireDefault(require('prop-types'));

var _react = _interopRequireDefault(require('react'));

var _AudioAttachment = _interopRequireDefault(require('../../Attachment/AudioAttachment'));

var _DownloadAttachment = _interopRequireDefault(require('../../Attachment/DownloadAttachment'));

var _ImageAttachment = _interopRequireDefault(require('../../Attachment/ImageAttachment'));

var _UploadAttachment = _interopRequireDefault(require('../../Attachment/UploadAttachment'));

var _TextAttachment = _interopRequireDefault(require('../../Attachment/TextAttachment'));

var _VideoAttachment = _interopRequireDefault(require('../../Attachment/VideoAttachment'));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

function hasThumbnail(_ref, attachment) {
  var _ref$attachments = _ref.attachments,
    attachments = _ref$attachments === void 0 ? (cov_1gj6ssiu1r.b[0][0]++, []) : _ref$attachments,
    _ref$channelData = _ref.channelData;
  _ref$channelData = _ref$channelData === void 0 ? (cov_1gj6ssiu1r.b[1][0]++, {}) : _ref$channelData;
  var _ref$channelData$atta = _ref$channelData.attachmentThumbnails,
    attachmentThumbnails = _ref$channelData$atta === void 0 ? (cov_1gj6ssiu1r.b[2][0]++, []) : _ref$channelData$atta;
  cov_1gj6ssiu1r.f[0]++;
  var attachmentIndex = (cov_1gj6ssiu1r.s[0]++, attachments.indexOf(attachment));
  cov_1gj6ssiu1r.s[1]++;
  return !!attachmentThumbnails[attachmentIndex];
} // TODO: [P4] Rename this file or the whole middleware, it looks either too simple or too comprehensive now

function createCoreMiddleware() {
  cov_1gj6ssiu1r.f[1]++;
  cov_1gj6ssiu1r.s[2]++;
  return function() {
    cov_1gj6ssiu1r.f[2]++;
    cov_1gj6ssiu1r.s[3]++;
    return function(next) {
      cov_1gj6ssiu1r.f[3]++;
      cov_1gj6ssiu1r.s[4]++;

      var Attachment = function Attachment(_ref2) {
        var _ref2$activity = _ref2.activity,
          activity = _ref2$activity === void 0 ? (cov_1gj6ssiu1r.b[3][0]++, {}) : _ref2$activity,
          _ref2$activity2 = _ref2.activity;
        _ref2$activity2 = _ref2$activity2 === void 0 ? (cov_1gj6ssiu1r.b[4][0]++, {}) : _ref2$activity2;
        var role = _ref2$activity2.from.role,
          attachment = _ref2.attachment,
          _ref2$attachment = _ref2.attachment;
        _ref2$attachment = _ref2$attachment === void 0 ? (cov_1gj6ssiu1r.b[5][0]++, {}) : _ref2$attachment;
        var contentType = _ref2$attachment.contentType,
          contentUrl = _ref2$attachment.contentUrl;
        cov_1gj6ssiu1r.f[4]++;
        cov_1gj6ssiu1r.s[5]++;
        return (cov_1gj6ssiu1r.b[7][0]++, role === 'user') &&
          (cov_1gj6ssiu1r.b[7][1]++, !/^text\//.test(contentType)) &&
          (cov_1gj6ssiu1r.b[7][2]++, !hasThumbnail(activity, attachment))
          ? (cov_1gj6ssiu1r.b[6][0]++,
            _react.default.createElement(_UploadAttachment.default, {
              activity: activity,
              attachment: attachment
            }))
          : (cov_1gj6ssiu1r.b[6][1]++,
            /^audio\//.test(contentType)
              ? (cov_1gj6ssiu1r.b[8][0]++,
                _react.default.createElement(_AudioAttachment.default, {
                  activity: activity,
                  attachment: attachment
                }))
              : (cov_1gj6ssiu1r.b[8][1]++,
                /^image\//.test(contentType)
                  ? (cov_1gj6ssiu1r.b[9][0]++,
                    _react.default.createElement(_ImageAttachment.default, {
                      activity: activity,
                      attachment: attachment
                    }))
                  : (cov_1gj6ssiu1r.b[9][1]++,
                    /^video\//.test(contentType)
                      ? (cov_1gj6ssiu1r.b[10][0]++,
                        _react.default.createElement(_VideoAttachment.default, {
                          activity: activity,
                          attachment: attachment
                        }))
                      : (cov_1gj6ssiu1r.b[10][1]++,
                        (cov_1gj6ssiu1r.b[12][0]++, contentUrl) ||
                        (cov_1gj6ssiu1r.b[12][1]++, contentType === 'application/octet-stream')
                          ? (cov_1gj6ssiu1r.b[11][0]++,
                            _react.default.createElement(_DownloadAttachment.default, {
                              activity: activity,
                              attachment: attachment
                            }))
                          : (cov_1gj6ssiu1r.b[11][1]++,
                            /^text\//.test(contentType)
                              ? (cov_1gj6ssiu1r.b[13][0]++,
                                _react.default.createElement(_TextAttachment.default, {
                                  activity: activity,
                                  attachment: attachment
                                }))
                              : (cov_1gj6ssiu1r.b[13][1]++,
                                next({
                                  activity: activity,
                                  attachment: attachment
                                })))))));
      };

      cov_1gj6ssiu1r.s[6]++;
      Attachment.propTypes = {
        activity: _propTypes.default.any.isRequired,
        attachment: _propTypes.default.shape({
          contentType: _propTypes.default.string.isRequired,
          contentUrl: _propTypes.default.string.isRequired
        }).isRequired
      };
      cov_1gj6ssiu1r.s[7]++;
      return Attachment;
    };
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9NaWRkbGV3YXJlL0F0dGFjaG1lbnQvY3JlYXRlQ29yZU1pZGRsZXdhcmUuanMiXSwibmFtZXMiOlsiaGFzVGh1bWJuYWlsIiwiYXR0YWNobWVudCIsImF0dGFjaG1lbnRzIiwiY2hhbm5lbERhdGEiLCJhdHRhY2htZW50VGh1bWJuYWlscyIsImF0dGFjaG1lbnRJbmRleCIsImluZGV4T2YiLCJjcmVhdGVDb3JlTWlkZGxld2FyZSIsIm5leHQiLCJBdHRhY2htZW50IiwiYWN0aXZpdHkiLCJyb2xlIiwiZnJvbSIsImNvbnRlbnRUeXBlIiwiY29udGVudFVybCIsInRlc3QiLCJwcm9wVHlwZXMiLCJQcm9wVHlwZXMiLCJhbnkiLCJpc1JlcXVpcmVkIiwic2hhcGUiLCJzdHJpbmciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QUFVLENBQUNPLFNBQVgsR0FBdUI7QUFDckJOLFFBQUFBLFFBQVEsRUFBRU8sbUJBQVVDLEdBQVYsQ0FBY0MsVUFESDtBQUVyQmxCLFFBQUFBLFVBQVUsRUFBRWdCLG1CQUFVRyxLQUFWLENBQWdCO0FBQzFCUCxVQUFBQSxXQUFXLEVBQUVJLG1CQUFVSSxNQUFWLENBQWlCRixVQURKO0FBRTFCTCxVQUFBQSxVQUFVLEVBQUVHLG1CQUFVSSxNQUFWLENBQWlCRjtBQUZILFNBQWhCLEVBR1RBO0FBTGtCLE9BQXZCO0FBdkJtQjtBQStCbkIsYUFBT1YsVUFBUDtBQUNELEtBaENZO0FBZ0NaLEdBaENEO0FBaUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmltcG9ydCBBdWRpb0F0dGFjaG1lbnQgZnJvbSAnLi4vLi4vQXR0YWNobWVudC9BdWRpb0F0dGFjaG1lbnQnO1xuaW1wb3J0IERvd25sb2FkQXR0YWNobWVudCBmcm9tICcuLi8uLi9BdHRhY2htZW50L0Rvd25sb2FkQXR0YWNobWVudCc7XG5pbXBvcnQgSW1hZ2VBdHRhY2htZW50IGZyb20gJy4uLy4uL0F0dGFjaG1lbnQvSW1hZ2VBdHRhY2htZW50JztcbmltcG9ydCBVcGxvYWRBdHRhY2htZW50IGZyb20gJy4uLy4uL0F0dGFjaG1lbnQvVXBsb2FkQXR0YWNobWVudCc7XG5pbXBvcnQgVGV4dEF0dGFjaG1lbnQgZnJvbSAnLi4vLi4vQXR0YWNobWVudC9UZXh0QXR0YWNobWVudCc7XG5pbXBvcnQgVmlkZW9BdHRhY2htZW50IGZyb20gJy4uLy4uL0F0dGFjaG1lbnQvVmlkZW9BdHRhY2htZW50JztcblxuZnVuY3Rpb24gaGFzVGh1bWJuYWlsKHsgYXR0YWNobWVudHMgPSBbXSwgY2hhbm5lbERhdGE6IHsgYXR0YWNobWVudFRodW1ibmFpbHMgPSBbXSB9ID0ge30gfSwgYXR0YWNobWVudCkge1xuICBjb25zdCBhdHRhY2htZW50SW5kZXggPSBhdHRhY2htZW50cy5pbmRleE9mKGF0dGFjaG1lbnQpO1xuXG4gIHJldHVybiAhIWF0dGFjaG1lbnRUaHVtYm5haWxzW2F0dGFjaG1lbnRJbmRleF07XG59XG5cbi8vIFRPRE86IFtQNF0gUmVuYW1lIHRoaXMgZmlsZSBvciB0aGUgd2hvbGUgbWlkZGxld2FyZSwgaXQgbG9va3MgZWl0aGVyIHRvbyBzaW1wbGUgb3IgdG9vIGNvbXByZWhlbnNpdmUgbm93XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjcmVhdGVDb3JlTWlkZGxld2FyZSgpIHtcbiAgcmV0dXJuICgpID0+IG5leHQgPT4ge1xuICAgIGNvbnN0IEF0dGFjaG1lbnQgPSAoe1xuICAgICAgYWN0aXZpdHkgPSB7fSxcbiAgICAgIGFjdGl2aXR5OiB7IGZyb206IHsgcm9sZSB9IH0gPSB7fSxcbiAgICAgIGF0dGFjaG1lbnQsXG4gICAgICBhdHRhY2htZW50OiB7IGNvbnRlbnRUeXBlLCBjb250ZW50VXJsIH0gPSB7fVxuICAgIH0pID0+XG4gICAgICByb2xlID09PSAndXNlcicgJiYgIS9edGV4dFxcLy91LnRlc3QoY29udGVudFR5cGUpICYmICFoYXNUaHVtYm5haWwoYWN0aXZpdHksIGF0dGFjaG1lbnQpID8gKFxuICAgICAgICA8VXBsb2FkQXR0YWNobWVudCBhY3Rpdml0eT17YWN0aXZpdHl9IGF0dGFjaG1lbnQ9e2F0dGFjaG1lbnR9IC8+XG4gICAgICApIDogL15hdWRpb1xcLy91LnRlc3QoY29udGVudFR5cGUpID8gKFxuICAgICAgICA8QXVkaW9BdHRhY2htZW50IGFjdGl2aXR5PXthY3Rpdml0eX0gYXR0YWNobWVudD17YXR0YWNobWVudH0gLz5cbiAgICAgICkgOiAvXmltYWdlXFwvL3UudGVzdChjb250ZW50VHlwZSkgPyAoXG4gICAgICAgIDxJbWFnZUF0dGFjaG1lbnQgYWN0aXZpdHk9e2FjdGl2aXR5fSBhdHRhY2htZW50PXthdHRhY2htZW50fSAvPlxuICAgICAgKSA6IC9edmlkZW9cXC8vdS50ZXN0KGNvbnRlbnRUeXBlKSA/IChcbiAgICAgICAgPFZpZGVvQXR0YWNobWVudCBhY3Rpdml0eT17YWN0aXZpdHl9IGF0dGFjaG1lbnQ9e2F0dGFjaG1lbnR9IC8+XG4gICAgICApIDogY29udGVudFVybCB8fCBjb250ZW50VHlwZSA9PT0gJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbScgPyAoXG4gICAgICAgIDxEb3dubG9hZEF0dGFjaG1lbnQgYWN0aXZpdHk9e2FjdGl2aXR5fSBhdHRhY2htZW50PXthdHRhY2htZW50fSAvPlxuICAgICAgKSA6IC9edGV4dFxcLy91LnRlc3QoY29udGVudFR5cGUpID8gKFxuICAgICAgICA8VGV4dEF0dGFjaG1lbnQgYWN0aXZpdHk9e2FjdGl2aXR5fSBhdHRhY2htZW50PXthdHRhY2htZW50fSAvPlxuICAgICAgKSA6IChcbiAgICAgICAgbmV4dCh7IGFjdGl2aXR5LCBhdHRhY2htZW50IH0pXG4gICAgICApO1xuXG4gICAgQXR0YWNobWVudC5wcm9wVHlwZXMgPSB7XG4gICAgICBhY3Rpdml0eTogUHJvcFR5cGVzLmFueS5pc1JlcXVpcmVkLFxuICAgICAgYXR0YWNobWVudDogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgY29udGVudFR5cGU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgICAgY29udGVudFVybDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkXG4gICAgICB9KS5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIHJldHVybiBBdHRhY2htZW50O1xuICB9O1xufVxuIl19
