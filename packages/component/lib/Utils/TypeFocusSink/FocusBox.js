'use strict';

var cov_ymgjxerg9 = (function() {
  var path = '/Users/guy/Work/Leo/leo/BotFramework-WebChat/packages/component/src/Utils/TypeFocusSink/FocusBox.js';
  var hash = 'ccf1b030c94d171e0756184adb4040418ba33fa5';
  var global = new Function('return this')();
  var gcv = '__coverage__';
  var coverageData = {
    path: '/Users/guy/Work/Leo/leo/BotFramework-WebChat/packages/component/src/Utils/TypeFocusSink/FocusBox.js',
    statementMap: {
      '0': {
        start: {
          line: 11,
          column: 22
        },
        end: {
          line: 11,
          column: 36
        }
      },
      '1': {
        start: {
          line: 13,
          column: 17
        },
        end: {
          line: 61,
          column: 1
        }
      },
      '2': {
        start: {
          line: 14,
          column: 30
        },
        end: {
          line: 14,
          column: 42
        }
      },
      '3': {
        start: {
          line: 15,
          column: 30
        },
        end: {
          line: 18,
          column: 4
        }
      },
      '4': {
        start: {
          line: 15,
          column: 44
        },
        end: {
          line: 15,
          column: 83
        }
      },
      '5': {
        start: {
          line: 20,
          column: 18
        },
        end: {
          line: 25,
          column: 3
        }
      },
      '6': {
        start: {
          line: 21,
          column: 11
        },
        end: {
          line: 23,
          column: 5
        }
      },
      '7': {
        start: {
          line: 27,
          column: 16
        },
        end: {
          line: 31,
          column: 27
        }
      },
      '8': {
        start: {
          line: 28,
          column: 24
        },
        end: {
          line: 28,
          column: 43
        }
      },
      '9': {
        start: {
          line: 30,
          column: 4
        },
        end: {
          line: 30,
          column: 31
        }
      },
      '10': {
        start: {
          line: 33,
          column: 31
        },
        end: {
          line: 52,
          column: 3
        }
      },
      '11': {
        start: {
          line: 35,
          column: 56
        },
        end: {
          line: 35,
          column: 61
        }
      },
      '12': {
        start: {
          line: 36,
          column: 23
        },
        end: {
          line: 36,
          column: 42
        }
      },
      '13': {
        start: {
          line: 38,
          column: 6
        },
        end: {
          line: 43,
          column: 7
        }
      },
      '14': {
        start: {
          line: 42,
          column: 8
        },
        end: {
          line: 42,
          column: 15
        }
      },
      '15': {
        start: {
          line: 45,
          column: 6
        },
        end: {
          line: 49,
          column: 7
        }
      },
      '16': {
        start: {
          line: 46,
          column: 8
        },
        end: {
          line: 46,
          column: 32
        }
      },
      '17': {
        start: {
          line: 48,
          column: 8
        },
        end: {
          line: 48,
          column: 16
        }
      },
      '18': {
        start: {
          line: 54,
          column: 2
        },
        end: {
          line: 60,
          column: 4
        }
      },
      '19': {
        start: {
          line: 63,
          column: 0
        },
        end: {
          line: 66,
          column: 2
        }
      },
      '20': {
        start: {
          line: 68,
          column: 0
        },
        end: {
          line: 76,
          column: 2
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 13,
            column: 17
          },
          end: {
            line: 13,
            column: 18
          }
        },
        loc: {
          start: {
            line: 13,
            column: 92
          },
          end: {
            line: 61,
            column: 1
          }
        },
        line: 13
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 15,
            column: 38
          },
          end: {
            line: 15,
            column: 39
          }
        },
        loc: {
          start: {
            line: 15,
            column: 44
          },
          end: {
            line: 15,
            column: 83
          }
        },
        line: 15
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 21,
            column: 4
          },
          end: {
            line: 21,
            column: 5
          }
        },
        loc: {
          start: {
            line: 21,
            column: 11
          },
          end: {
            line: 23,
            column: 5
          }
        },
        line: 21
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 27,
            column: 28
          },
          end: {
            line: 27,
            column: 29
          }
        },
        loc: {
          start: {
            line: 27,
            column: 34
          },
          end: {
            line: 31,
            column: 3
          }
        },
        line: 27
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 34,
            column: 4
          },
          end: {
            line: 34,
            column: 5
          }
        },
        loc: {
          start: {
            line: 34,
            column: 13
          },
          end: {
            line: 50,
            column: 5
          }
        },
        line: 34
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 15,
            column: 44
          },
          end: {
            line: 15,
            column: 83
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 15,
              column: 44
            },
            end: {
              line: 15,
              column: 60
            }
          },
          {
            start: {
              line: 15,
              column: 64
            },
            end: {
              line: 15,
              column: 83
            }
          }
        ],
        line: 15
      },
      '1': {
        loc: {
          start: {
            line: 30,
            column: 4
          },
          end: {
            line: 30,
            column: 30
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 30,
              column: 4
            },
            end: {
              line: 30,
              column: 11
            }
          },
          {
            start: {
              line: 30,
              column: 15
            },
            end: {
              line: 30,
              column: 30
            }
          }
        ],
        line: 30
      },
      '2': {
        loc: {
          start: {
            line: 38,
            column: 6
          },
          end: {
            line: 43,
            column: 7
          }
        },
        type: 'if',
        locations: [
          {
            start: {
              line: 38,
              column: 6
            },
            end: {
              line: 43,
              column: 7
            }
          },
          {
            start: {
              line: 38,
              column: 6
            },
            end: {
              line: 43,
              column: 7
            }
          }
        ],
        line: 38
      },
      '3': {
        loc: {
          start: {
            line: 38,
            column: 10
          },
          end: {
            line: 38,
            column: 103
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 38,
              column: 10
            },
            end: {
              line: 38,
              column: 16
            }
          },
          {
            start: {
              line: 38,
              column: 21
            },
            end: {
              line: 38,
              column: 28
            }
          },
          {
            start: {
              line: 38,
              column: 32
            },
            end: {
              line: 38,
              column: 43
            }
          },
          {
            start: {
              line: 38,
              column: 48
            },
            end: {
              line: 38,
              column: 55
            }
          },
          {
            start: {
              line: 38,
              column: 60
            },
            end: {
              line: 38,
              column: 79
            }
          },
          {
            start: {
              line: 38,
              column: 83
            },
            end: {
              line: 38,
              column: 102
            }
          }
        ],
        line: 38
      },
      '4': {
        loc: {
          start: {
            line: 45,
            column: 6
          },
          end: {
            line: 49,
            column: 7
          }
        },
        type: 'if',
        locations: [
          {
            start: {
              line: 45,
              column: 6
            },
            end: {
              line: 49,
              column: 7
            }
          },
          {
            start: {
              line: 45,
              column: 6
            },
            end: {
              line: 49,
              column: 7
            }
          }
        ],
        line: 45
      },
      '5': {
        loc: {
          start: {
            line: 45,
            column: 10
          },
          end: {
            line: 45,
            column: 54
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 45,
              column: 10
            },
            end: {
              line: 45,
              column: 38
            }
          },
          {
            start: {
              line: 45,
              column: 42
            },
            end: {
              line: 45,
              column: 54
            }
          }
        ],
        line: 45
      },
      '6': {
        loc: {
          start: {
            line: 56,
            column: 45
          },
          end: {
            line: 56,
            column: 78
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 56,
              column: 45
            },
            end: {
              line: 56,
              column: 54
            }
          },
          {
            start: {
              line: 56,
              column: 58
            },
            end: {
              line: 56,
              column: 78
            }
          }
        ],
        line: 56
      },
      '7': {
        loc: {
          start: {
            line: 57,
            column: 9
          },
          end: {
            line: 57,
            column: 72
          }
        },
        type: 'cond-expr',
        locations: [
          {
            start: {
              line: 57,
              column: 42
            },
            end: {
              line: 57,
              column: 61
            }
          },
          {
            start: {
              line: 57,
              column: 64
            },
            end: {
              line: 57,
              column: 72
            }
          }
        ],
        line: 57
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0
    },
    b: {
      '0': [0, 0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0, 0, 0, 0, 0],
      '4': [0, 0],
      '5': [0, 0],
      '6': [0, 0],
      '7': [0, 0]
    },
    _coverageSchema: '43e27e138ebf9cfc5966b082cf9a028302ed4184',
    hash: 'ccf1b030c94d171e0756184adb4040418ba33fa5'
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  return (coverage[path] = coverageData);
})();

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.default = void 0;

var _propTypes = _interopRequireDefault(require('prop-types'));

var _react = _interopRequireWildcard(require('react'));

var _Context = _interopRequireDefault(require('./Context'));

var _getTabIndex = _interopRequireDefault(require('./getTabIndex'));

var _inputtableKey = _interopRequireDefault(require('./inputtableKey'));

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};
    if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) {
          var desc =
            Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};
          if (desc.get || desc.set) {
            Object.defineProperty(newObj, key, desc);
          } else {
            newObj[key] = obj[key];
          }
        }
      }
    }
    newObj.default = obj;
    return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

function _extends() {
  _extends =
    Object.assign ||
    function(target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];
        for (var key in source) {
          if (Object.prototype.hasOwnProperty.call(source, key)) {
            target[key] = source[key];
          }
        }
      }
      return target;
    };
  return _extends.apply(this, arguments);
}

function _objectWithoutProperties(source, excluded) {
  if (source == null) return {};
  var target = _objectWithoutPropertiesLoose(source, excluded);
  var key, i;
  if (Object.getOwnPropertySymbols) {
    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);
    for (i = 0; i < sourceSymbolKeys.length; i++) {
      key = sourceSymbolKeys[i];
      if (excluded.indexOf(key) >= 0) continue;
      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
      target[key] = source[key];
    }
  }
  return target;
}

function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;
  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0) continue;
    target[key] = source[key];
  }
  return target;
}

var DEFAULT_STYLE =
  (cov_ymgjxerg9.s[0]++,
  {
    outline: 0
  });
cov_ymgjxerg9.s[1]++;

var FocusBox = function FocusBox(_ref) {
  var children = _ref.children,
    disabled = _ref.disabled,
    sendFocusRefProp = _ref.sendFocusRef,
    otherProps = _objectWithoutProperties(_ref, ['children', 'disabled', 'sendFocusRef']);

  cov_ymgjxerg9.f[0]++;
  var sendFocusRefPersist = (cov_ymgjxerg9.s[2]++, (0, _react.useRef)(null));
  var patchedSendFocusRef =
    (cov_ymgjxerg9.s[3]++,
    (0, _react.useMemo)(
      function() {
        cov_ymgjxerg9.f[1]++;
        cov_ymgjxerg9.s[4]++;
        return (cov_ymgjxerg9.b[0][0]++, sendFocusRefProp) || (cov_ymgjxerg9.b[0][1]++, sendFocusRefPersist);
      },
      [sendFocusRefPersist, sendFocusRefProp]
    ));
  var context =
    (cov_ymgjxerg9.s[5]++,
    (0, _react.useMemo)(
      function() {
        cov_ymgjxerg9.f[2]++;
        cov_ymgjxerg9.s[6]++;
        return {
          sendFocusRef: patchedSendFocusRef
        };
      },
      [patchedSendFocusRef]
    ));
  var focus =
    (cov_ymgjxerg9.s[7]++,
    (0, _react.useCallback)(
      function() {
        cov_ymgjxerg9.f[3]++;

        var _ref2 = (cov_ymgjxerg9.s[8]++, patchedSendFocusRef),
          current = _ref2.current;

        cov_ymgjxerg9.s[9]++;
        (cov_ymgjxerg9.b[1][0]++, current) && (cov_ymgjxerg9.b[1][1]++, current.focus());
      },
      [patchedSendFocusRef]
    ));
  var handleKeyDownCapture =
    (cov_ymgjxerg9.s[10]++,
    (0, _react.useCallback)(
      function(event) {
        cov_ymgjxerg9.f[4]++;

        var _ref3 = (cov_ymgjxerg9.s[11]++, event),
          altKey = _ref3.altKey,
          ctrlKey = _ref3.ctrlKey,
          key = _ref3.key,
          metaKey = _ref3.metaKey,
          target = _ref3.target;

        var tabIndex = (cov_ymgjxerg9.s[12]++, (0, _getTabIndex.default)(target));
        cov_ymgjxerg9.s[13]++;

        if (
          (cov_ymgjxerg9.b[3][0]++, altKey) ||
          ((cov_ymgjxerg9.b[3][1]++, ctrlKey) && (cov_ymgjxerg9.b[3][2]++, key !== 'v')) ||
          (cov_ymgjxerg9.b[3][3]++, metaKey) ||
          ((cov_ymgjxerg9.b[3][4]++, !(0, _inputtableKey.default)(key)) &&
            (cov_ymgjxerg9.b[3][5]++, key !== 'Backspace'))
        ) {
          cov_ymgjxerg9.b[2][0]++;
          cov_ymgjxerg9.s[14]++;
          // Ignore if one of the utility key (except SHIFT) is pressed
          // E.g. CTRL-C on a link in one of the message should not jump to chat box
          // E.g. "A" or "Backspace" should jump to chat box
          return;
        } else {
          cov_ymgjxerg9.b[2][1]++;
        }

        cov_ymgjxerg9.s[15]++;

        if ((cov_ymgjxerg9.b[5][0]++, typeof tabIndex !== 'number') || (cov_ymgjxerg9.b[5][1]++, tabIndex < 0)) {
          cov_ymgjxerg9.b[4][0]++;
          cov_ymgjxerg9.s[16]++;
          event.stopPropagation();
          cov_ymgjxerg9.s[17]++;
          focus();
        } else {
          cov_ymgjxerg9.b[4][1]++;
        }
      },
      [focus]
    ));
  cov_ymgjxerg9.s[18]++;
  return _react.default.createElement(
    _Context.default.Provider,
    {
      value: context
    },
    _react.default.createElement(
      'div',
      _extends({}, otherProps, {
        onKeyDownCapture: (cov_ymgjxerg9.b[6][0]++, !disabled) && (cov_ymgjxerg9.b[6][1]++, handleKeyDownCapture),
        style: DEFAULT_STYLE,
        tabIndex: -1
      }),
      typeof children === 'function'
        ? (cov_ymgjxerg9.b[7][0]++,
          children({
            focus: focus
          }))
        : (cov_ymgjxerg9.b[7][1]++, children)
    )
  );
};

cov_ymgjxerg9.s[19]++;
FocusBox.defaultProps = {
  children: undefined,
  disabled: false
};
cov_ymgjxerg9.s[20]++;
FocusBox.propTypes = {
  children: _propTypes.default.any,
  disabled: _propTypes.default.bool,
  sendFocusRef: _propTypes.default.shape({
    current: _propTypes.default.shape({
      focus: _propTypes.default.func
    })
  }).isRequired
};
var _default = FocusBox;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9VdGlscy9UeXBlRm9jdXNTaW5rL0ZvY3VzQm94LmpzIl0sIm5hbWVzIjpbIkRFRkFVTFRfU1RZTEUiLCJvdXRsaW5lIiwiRm9jdXNCb3giLCJjaGlsZHJlbiIsImRpc2FibGVkIiwic2VuZEZvY3VzUmVmUHJvcCIsInNlbmRGb2N1c1JlZiIsIm90aGVyUHJvcHMiLCJzZW5kRm9jdXNSZWZQZXJzaXN0IiwicGF0Y2hlZFNlbmRGb2N1c1JlZiIsImNvbnRleHQiLCJmb2N1cyIsImN1cnJlbnQiLCJoYW5kbGVLZXlEb3duQ2FwdHVyZSIsImV2ZW50IiwiYWx0S2V5IiwiY3RybEtleSIsImtleSIsIm1ldGFLZXkiLCJ0YXJnZXQiLCJ0YWJJbmRleCIsInN0b3BQcm9wYWdhdGlvbiIsImRlZmF1bHRQcm9wcyIsInVuZGVmaW5lZCIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsImFueSIsImJvb2wiLCJzaGFwZSIsImZ1bmMiLCJpc1JlcXVpcmVkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFHQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7Ozs7O0FBRUEsSUFBTUEsYUFBYSwwQkFBRztBQUFFQyxFQUFBQSxPQUFPLEVBQUU7QUFBWCxDQUFILENBQW5COzs7QUFFQSxJQUFNQyxRQUFRLEdBQUcsU0FBWEEsUUFBVyxPQUEyRTtBQUFBLE1BQXhFQyxRQUF3RSxRQUF4RUEsUUFBd0U7QUFBQSxNQUE5REMsUUFBOEQsUUFBOURBLFFBQThEO0FBQUEsTUFBdENDLGdCQUFzQyxRQUFwREMsWUFBb0Q7QUFBQSxNQUFqQkMsVUFBaUI7O0FBQUE7QUFDMUYsTUFBTUMsbUJBQW1CLDBCQUFHLG1CQUFPLElBQVAsQ0FBSCxDQUF6QjtBQUNBLE1BQU1DLG1CQUFtQiwwQkFBRyxvQkFBUSxZQUFNO0FBQUE7QUFBQTtBQUFBLHFDQUFBSixnQkFBZ0IsK0JBQUlHLG1CQUFKLENBQWhCO0FBQXVDLEdBQXJELEVBQXVELENBQ2pGQSxtQkFEaUYsRUFFakZILGdCQUZpRixDQUF2RCxDQUFILENBQXpCO0FBS0EsTUFBTUssT0FBTywwQkFBRyxvQkFDZCxZQUFPO0FBQUE7QUFBQTtBQUFBO0FBQ0xKLE1BQUFBLFlBQVksRUFBRUc7QUFEVDtBQUVOLEdBSGEsRUFJZCxDQUFDQSxtQkFBRCxDQUpjLENBQUgsQ0FBYjtBQU9BLE1BQU1FLEtBQUssMEJBQUcsd0JBQVksWUFBTTtBQUFBOztBQUFBLHVDQUNWRixtQkFEVTtBQUFBLFFBQ3RCRyxPQURzQixTQUN0QkEsT0FEc0I7O0FBQUE7QUFHOUIsOEJBQUFBLE9BQU8sK0JBQUlBLE9BQU8sQ0FBQ0QsS0FBUixFQUFKLENBQVA7QUFDRCxHQUphLEVBSVgsQ0FBQ0YsbUJBQUQsQ0FKVyxDQUFILENBQVg7QUFNQSxNQUFNSSxvQkFBb0IsMkJBQUcsd0JBQzNCLFVBQUFDLEtBQUssRUFBSTtBQUFBOztBQUFBLHdDQUMyQ0EsS0FEM0M7QUFBQSxRQUNDQyxNQURELFNBQ0NBLE1BREQ7QUFBQSxRQUNTQyxPQURULFNBQ1NBLE9BRFQ7QUFBQSxRQUNrQkMsR0FEbEIsU0FDa0JBLEdBRGxCO0FBQUEsUUFDdUJDLE9BRHZCLFNBQ3VCQSxPQUR2QjtBQUFBLFFBQ2dDQyxNQURoQyxTQUNnQ0EsTUFEaEM7O0FBRVAsUUFBTUMsUUFBUSwyQkFBRywwQkFBWUQsTUFBWixDQUFILENBQWQ7QUFGTzs7QUFJUCxRQUFJLDBCQUFBSixNQUFNLEtBQUssMEJBQUFDLE9BQU8sK0JBQUlDLEdBQUcsS0FBSyxHQUFaLENBQWxCLDhCQUFzQ0MsT0FBdEMsS0FBa0QsMkJBQUMsNEJBQWNELEdBQWQsQ0FBRCwrQkFBdUJBLEdBQUcsS0FBSyxXQUEvQixDQUF0RCxFQUFtRztBQUFBO0FBQUE7QUFDakc7QUFDQTtBQUNBO0FBQ0E7QUFDRCxLQUxEO0FBQUE7QUFBQTs7QUFKTzs7QUFXUCxRQUFJLGlDQUFPRyxRQUFQLEtBQW9CLFFBQXBCLCtCQUFnQ0EsUUFBUSxHQUFHLENBQTNDLENBQUosRUFBa0Q7QUFBQTtBQUFBO0FBQ2hETixNQUFBQSxLQUFLLENBQUNPLGVBQU47QUFEZ0Q7QUFHaERWLE1BQUFBLEtBQUs7QUFDTixLQUpEO0FBQUE7QUFBQTtBQUtELEdBakIwQixFQWtCM0IsQ0FBQ0EsS0FBRCxDQWxCMkIsQ0FBSCxDQUExQjtBQXBCMEY7QUF5QzFGLFNBQ0UsNkJBQUMsZ0JBQUQsQ0FBUyxRQUFUO0FBQWtCLElBQUEsS0FBSyxFQUFFRDtBQUF6QixLQUNFLGlEQUFTSCxVQUFUO0FBQXFCLElBQUEsZ0JBQWdCLEVBQUUsMkJBQUNILFFBQUQsK0JBQWFTLG9CQUFiLENBQXZDO0FBQTBFLElBQUEsS0FBSyxFQUFFYixhQUFqRjtBQUFnRyxJQUFBLFFBQVEsRUFBRSxDQUFDO0FBQTNHLE1BQ0csT0FBT0csUUFBUCxLQUFvQixVQUFwQiw2QkFBaUNBLFFBQVEsQ0FBQztBQUFFUSxJQUFBQSxLQUFLLEVBQUxBO0FBQUYsR0FBRCxDQUF6Qyw4QkFBdURSLFFBQXZELENBREgsQ0FERixDQURGO0FBT0QsQ0FoREQ7OztBQWtEQUQsUUFBUSxDQUFDb0IsWUFBVCxHQUF3QjtBQUN0Qm5CLEVBQUFBLFFBQVEsRUFBRW9CLFNBRFk7QUFFdEJuQixFQUFBQSxRQUFRLEVBQUU7QUFGWSxDQUF4Qjs7QUFLQUYsUUFBUSxDQUFDc0IsU0FBVCxHQUFxQjtBQUNuQnJCLEVBQUFBLFFBQVEsRUFBRXNCLG1CQUFVQyxHQUREO0FBRW5CdEIsRUFBQUEsUUFBUSxFQUFFcUIsbUJBQVVFLElBRkQ7QUFHbkJyQixFQUFBQSxZQUFZLEVBQUVtQixtQkFBVUcsS0FBVixDQUFnQjtBQUM1QmhCLElBQUFBLE9BQU8sRUFBRWEsbUJBQVVHLEtBQVYsQ0FBZ0I7QUFDdkJqQixNQUFBQSxLQUFLLEVBQUVjLG1CQUFVSTtBQURNLEtBQWhCO0FBRG1CLEdBQWhCLEVBSVhDO0FBUGdCLENBQXJCO2VBVWU1QixRIiwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhpcyBpcyBmb3IgZGVmYXVsdFByb3BzOiB7IGNoaWxkcmVuOiB1bmRlZmluZWQgfVxuLyogZXNsaW50IG5vLXVuZGVmaW5lZDogXCJvZmZcIiAqL1xuXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IFJlYWN0LCB7IHVzZUNhbGxiYWNrLCB1c2VNZW1vLCB1c2VSZWYgfSBmcm9tICdyZWFjdCc7XG5cbmltcG9ydCBDb250ZXh0IGZyb20gJy4vQ29udGV4dCc7XG5pbXBvcnQgZ2V0VGFiSW5kZXggZnJvbSAnLi9nZXRUYWJJbmRleCc7XG5pbXBvcnQgaW5wdXR0YWJsZUtleSBmcm9tICcuL2lucHV0dGFibGVLZXknO1xuXG5jb25zdCBERUZBVUxUX1NUWUxFID0geyBvdXRsaW5lOiAwIH07XG5cbmNvbnN0IEZvY3VzQm94ID0gKHsgY2hpbGRyZW4sIGRpc2FibGVkLCBzZW5kRm9jdXNSZWY6IHNlbmRGb2N1c1JlZlByb3AsIC4uLm90aGVyUHJvcHMgfSkgPT4ge1xuICBjb25zdCBzZW5kRm9jdXNSZWZQZXJzaXN0ID0gdXNlUmVmKG51bGwpO1xuICBjb25zdCBwYXRjaGVkU2VuZEZvY3VzUmVmID0gdXNlTWVtbygoKSA9PiBzZW5kRm9jdXNSZWZQcm9wIHx8IHNlbmRGb2N1c1JlZlBlcnNpc3QsIFtcbiAgICBzZW5kRm9jdXNSZWZQZXJzaXN0LFxuICAgIHNlbmRGb2N1c1JlZlByb3BcbiAgXSk7XG5cbiAgY29uc3QgY29udGV4dCA9IHVzZU1lbW8oXG4gICAgKCkgPT4gKHtcbiAgICAgIHNlbmRGb2N1c1JlZjogcGF0Y2hlZFNlbmRGb2N1c1JlZlxuICAgIH0pLFxuICAgIFtwYXRjaGVkU2VuZEZvY3VzUmVmXVxuICApO1xuXG4gIGNvbnN0IGZvY3VzID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNvbnN0IHsgY3VycmVudCB9ID0gcGF0Y2hlZFNlbmRGb2N1c1JlZjtcblxuICAgIGN1cnJlbnQgJiYgY3VycmVudC5mb2N1cygpO1xuICB9LCBbcGF0Y2hlZFNlbmRGb2N1c1JlZl0pO1xuXG4gIGNvbnN0IGhhbmRsZUtleURvd25DYXB0dXJlID0gdXNlQ2FsbGJhY2soXG4gICAgZXZlbnQgPT4ge1xuICAgICAgY29uc3QgeyBhbHRLZXksIGN0cmxLZXksIGtleSwgbWV0YUtleSwgdGFyZ2V0IH0gPSBldmVudDtcbiAgICAgIGNvbnN0IHRhYkluZGV4ID0gZ2V0VGFiSW5kZXgodGFyZ2V0KTtcblxuICAgICAgaWYgKGFsdEtleSB8fCAoY3RybEtleSAmJiBrZXkgIT09ICd2JykgfHwgbWV0YUtleSB8fCAoIWlucHV0dGFibGVLZXkoa2V5KSAmJiBrZXkgIT09ICdCYWNrc3BhY2UnKSkge1xuICAgICAgICAvLyBJZ25vcmUgaWYgb25lIG9mIHRoZSB1dGlsaXR5IGtleSAoZXhjZXB0IFNISUZUKSBpcyBwcmVzc2VkXG4gICAgICAgIC8vIEUuZy4gQ1RSTC1DIG9uIGEgbGluayBpbiBvbmUgb2YgdGhlIG1lc3NhZ2Ugc2hvdWxkIG5vdCBqdW1wIHRvIGNoYXQgYm94XG4gICAgICAgIC8vIEUuZy4gXCJBXCIgb3IgXCJCYWNrc3BhY2VcIiBzaG91bGQganVtcCB0byBjaGF0IGJveFxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgdGFiSW5kZXggIT09ICdudW1iZXInIHx8IHRhYkluZGV4IDwgMCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICBmb2N1cygpO1xuICAgICAgfVxuICAgIH0sXG4gICAgW2ZvY3VzXVxuICApO1xuXG4gIHJldHVybiAoXG4gICAgPENvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2NvbnRleHR9PlxuICAgICAgPGRpdiB7Li4ub3RoZXJQcm9wc30gb25LZXlEb3duQ2FwdHVyZT17IWRpc2FibGVkICYmIGhhbmRsZUtleURvd25DYXB0dXJlfSBzdHlsZT17REVGQVVMVF9TVFlMRX0gdGFiSW5kZXg9ey0xfT5cbiAgICAgICAge3R5cGVvZiBjaGlsZHJlbiA9PT0gJ2Z1bmN0aW9uJyA/IGNoaWxkcmVuKHsgZm9jdXMgfSkgOiBjaGlsZHJlbn1cbiAgICAgIDwvZGl2PlxuICAgIDwvQ29udGV4dC5Qcm92aWRlcj5cbiAgKTtcbn07XG5cbkZvY3VzQm94LmRlZmF1bHRQcm9wcyA9IHtcbiAgY2hpbGRyZW46IHVuZGVmaW5lZCxcbiAgZGlzYWJsZWQ6IGZhbHNlXG59O1xuXG5Gb2N1c0JveC5wcm9wVHlwZXMgPSB7XG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LFxuICBkaXNhYmxlZDogUHJvcFR5cGVzLmJvb2wsXG4gIHNlbmRGb2N1c1JlZjogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICBjdXJyZW50OiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgZm9jdXM6IFByb3BUeXBlcy5mdW5jXG4gICAgfSlcbiAgfSkuaXNSZXF1aXJlZFxufTtcblxuZXhwb3J0IGRlZmF1bHQgRm9jdXNCb3g7XG4iXX0=
