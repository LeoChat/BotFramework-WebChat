'use strict';

var cov_1kx4056b2s = (function() {
  var path = '/home/guy/leo/BotFramework-WebChat/packages/component/src/SendBox/TextBox.js';
  var hash = 'e356869a6a67fb54b483ebd0afda8d584f72526e';
  var global = new Function('return this')();
  var gcv = '__coverage__';
  var coverageData = {
    path: '/home/guy/leo/BotFramework-WebChat/packages/component/src/SendBox/TextBox.js',
    statementMap: {
      '0': {
        start: {
          line: 12,
          column: 17
        },
        end: {
          line: 18,
          column: 2
        }
      },
      '1': {
        start: {
          line: 20,
          column: 27
        },
        end: {
          line: 56,
          column: 3
        }
      },
      '2': {
        start: {
          line: 21,
          column: 2
        },
        end: {
          line: 56,
          column: 3
        }
      },
      '3': {
        start: {
          line: 22,
          column: 114
        },
        end: {
          line: 54,
          column: 5
        }
      },
      '4': {
        start: {
          line: 26,
          column: 8
        },
        end: {
          line: 26,
          column: 26
        }
      },
      '5': {
        start: {
          line: 27,
          column: 8
        },
        end: {
          line: 27,
          column: 22
        }
      },
      '6': {
        start: {
          line: 30,
          column: 34
        },
        end: {
          line: 30,
          column: 39
        }
      },
      '7': {
        start: {
          line: 32,
          column: 8
        },
        end: {
          line: 40,
          column: 9
        }
      },
      '8': {
        start: {
          line: 33,
          column: 10
        },
        end: {
          line: 33,
          column: 33
        }
      },
      '9': {
        start: {
          line: 35,
          column: 10
        },
        end: {
          line: 39,
          column: 11
        }
      },
      '10': {
        start: {
          line: 36,
          column: 12
        },
        end: {
          line: 36,
          column: 26
        }
      },
      '11': {
        start: {
          line: 37,
          column: 12
        },
        end: {
          line: 37,
          column: 28
        }
      },
      '12': {
        start: {
          line: 38,
          column: 12
        },
        end: {
          line: 38,
          column: 27
        }
      },
      '13': {
        start: {
          line: 43,
          column: 8
        },
        end: {
          line: 43,
          column: 31
        }
      },
      '14': {
        start: {
          line: 48,
          column: 8
        },
        end: {
          line: 51,
          column: 9
        }
      },
      '15': {
        start: {
          line: 49,
          column: 10
        },
        end: {
          line: 49,
          column: 24
        }
      },
      '16': {
        start: {
          line: 50,
          column: 10
        },
        end: {
          line: 50,
          column: 26
        }
      },
      '17': {
        start: {
          line: 58,
          column: 16
        },
        end: {
          line: 104,
          column: 1
        }
      },
      '18': {
        start: {
          line: 59,
          column: 32
        },
        end: {
          line: 59,
          column: 49
        }
      },
      '19': {
        start: {
          line: 60,
          column: 97
        },
        end: {
          line: 60,
          column: 110
        }
      },
      '20': {
        start: {
          line: 61,
          column: 24
        },
        end: {
          line: 61,
          column: 46
        }
      },
      '21': {
        start: {
          line: 62,
          column: 32
        },
        end: {
          line: 62,
          column: 64
        }
      },
      '22': {
        start: {
          line: 64,
          column: 2
        },
        end: {
          line: 103,
          column: 4
        }
      },
      '23': {
        start: {
          line: 72,
          column: 12
        },
        end: {
          line: 98,
          column: 13
        }
      },
      '24': {
        start: {
          line: 106,
          column: 0
        },
        end: {
          line: 110,
          column: 2
        }
      },
      '25': {
        start: {
          line: 112,
          column: 0
        },
        end: {
          line: 119,
          column: 2
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 20,
            column: 27
          },
          end: {
            line: 20,
            column: 28
          }
        },
        loc: {
          start: {
            line: 21,
            column: 2
          },
          end: {
            line: 56,
            column: 3
          }
        },
        line: 21
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 22,
            column: 4
          },
          end: {
            line: 22,
            column: 5
          }
        },
        loc: {
          start: {
            line: 22,
            column: 114
          },
          end: {
            line: 54,
            column: 5
          }
        },
        line: 22
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 25,
            column: 16
          },
          end: {
            line: 25,
            column: 17
          }
        },
        loc: {
          start: {
            line: 25,
            column: 43
          },
          end: {
            line: 28,
            column: 7
          }
        },
        line: 25
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 29,
            column: 18
          },
          end: {
            line: 29,
            column: 19
          }
        },
        loc: {
          start: {
            line: 29,
            column: 27
          },
          end: {
            line: 41,
            column: 7
          }
        },
        line: 29
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 42,
            column: 16
          },
          end: {
            line: 42,
            column: 17
          }
        },
        loc: {
          start: {
            line: 42,
            column: 25
          },
          end: {
            line: 52,
            column: 7
          }
        },
        line: 42
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 58,
            column: 16
          },
          end: {
            line: 58,
            column: 17
          }
        },
        loc: {
          start: {
            line: 58,
            column: 84
          },
          end: {
            line: 104,
            column: 1
          }
        },
        line: 58
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 71,
            column: 11
          },
          end: {
            line: 71,
            column: 12
          }
        },
        loc: {
          start: {
            line: 72,
            column: 12
          },
          end: {
            line: 98,
            column: 13
          }
        },
        line: 72
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 32,
            column: 8
          },
          end: {
            line: 40,
            column: 9
          }
        },
        type: 'if',
        locations: [
          {
            start: {
              line: 32,
              column: 8
            },
            end: {
              line: 40,
              column: 9
            }
          },
          {
            start: {
              line: 32,
              column: 8
            },
            end: {
              line: 40,
              column: 9
            }
          }
        ],
        line: 32
      },
      '1': {
        loc: {
          start: {
            line: 32,
            column: 12
          },
          end: {
            line: 32,
            column: 40
          }
        },
        type: 'binary-expr',
        locations: [
          {
            start: {
              line: 32,
              column: 12
            },
            end: {
              line: 32,
              column: 27
            }
          },
          {
            start: {
              line: 32,
              column: 31
            },
            end: {
              line: 32,
              column: 40
            }
          }
        ],
        line: 32
      },
      '2': {
        loc: {
          start: {
            line: 35,
            column: 10
          },
          end: {
            line: 39,
            column: 11
          }
        },
        type: 'if',
        locations: [
          {
            start: {
              line: 35,
              column: 10
            },
            end: {
              line: 39,
              column: 11
            }
          },
          {
            start: {
              line: 35,
              column: 10
            },
            end: {
              line: 39,
              column: 11
            }
          }
        ],
        line: 35
      },
      '3': {
        loc: {
          start: {
            line: 48,
            column: 8
          },
          end: {
            line: 51,
            column: 9
          }
        },
        type: 'if',
        locations: [
          {
            start: {
              line: 48,
              column: 8
            },
            end: {
              line: 51,
              column: 9
            }
          },
          {
            start: {
              line: 48,
              column: 8
            },
            end: {
              line: 51,
              column: 9
            }
          }
        ],
        line: 48
      },
      '4': {
        loc: {
          start: {
            line: 72,
            column: 12
          },
          end: {
            line: 98,
            column: 13
          }
        },
        type: 'cond-expr',
        locations: [
          {
            start: {
              line: 73,
              column: 14
            },
            end: {
              line: 82,
              column: 16
            }
          },
          {
            start: {
              line: 84,
              column: 14
            },
            end: {
              line: 97,
              column: 20
            }
          }
        ],
        line: 72
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0
    },
    b: {
      '0': [0, 0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0],
      '4': [0, 0]
    },
    _coverageSchema: '43e27e138ebf9cfc5966b082cf9a028302ed4184',
    hash: 'e356869a6a67fb54b483ebd0afda8d584f72526e'
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  return (coverage[path] = coverageData);
})();

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.connectSendTextBox = exports.default = void 0;

var _glamor = require('glamor');

var _classnames = _interopRequireDefault(require('classnames'));

var _propTypes = _interopRequireDefault(require('prop-types'));

var _react = _interopRequireDefault(require('react'));

var _TypeFocusSink = require('../Utils/TypeFocusSink');

var _connectToWebChat = _interopRequireDefault(require('../connectToWebChat'));

var _useLocalize = _interopRequireDefault(require('../hooks/useLocalize'));

var _useStyleOptions = _interopRequireDefault(require('../hooks/useStyleOptions'));

var _useStyleSet = _interopRequireDefault(require('../hooks/useStyleSet'));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

function _slicedToArray(arr, i) {
  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();
}

function _nonIterableRest() {
  throw new TypeError('Invalid attempt to destructure non-iterable instance');
}

function _iterableToArrayLimit(arr, i) {
  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === '[object Arguments]')) {
    return;
  }
  var _arr = [];
  var _n = true;
  var _d = false;
  var _e = undefined;
  try {
    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
      _arr.push(_s.value);
      if (i && _arr.length === i) break;
    }
  } catch (err) {
    _d = true;
    _e = err;
  } finally {
    try {
      if (!_n && _i['return'] != null) _i['return']();
    } finally {
      if (_d) throw _e;
    }
  }
  return _arr;
}

function _arrayWithHoles(arr) {
  if (Array.isArray(arr)) return arr;
}

var ROOT_CSS =
  (cov_1kx4056b2s.s[0]++,
  (0, _glamor.css)({
    display: 'flex',
    '& > div, input': {
      flex: 1
    }
  }));
cov_1kx4056b2s.s[1]++;

var connectSendTextBox = function connectSendTextBox() {
  cov_1kx4056b2s.f[0]++;
  cov_1kx4056b2s.s[2]++;

  for (var _len = arguments.length, selectors = new Array(_len), _key = 0; _key < _len; _key++) {
    selectors[_key] = arguments[_key];
  }

  return _connectToWebChat.default.apply(
    void 0,
    [
      function(_ref) {
        var disabled = _ref.disabled,
          focusSendBox = _ref.focusSendBox,
          language = _ref.language,
          scrollToEnd = _ref.scrollToEnd,
          sendBoxValue = _ref.sendBoxValue,
          setSendBox = _ref.setSendBox,
          stopDictate = _ref.stopDictate,
          submitSendBox = _ref.submitSendBox;
        cov_1kx4056b2s.f[1]++;
        cov_1kx4056b2s.s[3]++;
        return {
          disabled: disabled,
          language: language,
          onChange: function onChange(_ref2) {
            var value = _ref2.target.value;
            cov_1kx4056b2s.f[2]++;
            cov_1kx4056b2s.s[4]++;
            setSendBox(value);
            cov_1kx4056b2s.s[5]++;
            stopDictate();
          },
          onKeyPress: function onKeyPress(event) {
            cov_1kx4056b2s.f[3]++;

            var _ref3 = (cov_1kx4056b2s.s[6]++, event),
              key = _ref3.key,
              shiftKey = _ref3.shiftKey;

            cov_1kx4056b2s.s[7]++;

            if ((cov_1kx4056b2s.b[1][0]++, key === 'Enter') && (cov_1kx4056b2s.b[1][1]++, !shiftKey)) {
              cov_1kx4056b2s.b[0][0]++;
              cov_1kx4056b2s.s[8]++;
              event.preventDefault();
              cov_1kx4056b2s.s[9]++;

              if (sendBoxValue) {
                cov_1kx4056b2s.b[2][0]++;
                cov_1kx4056b2s.s[10]++;
                scrollToEnd();
                cov_1kx4056b2s.s[11]++;
                submitSendBox();
                cov_1kx4056b2s.s[12]++;
                focusSendBox();
              } else {
                cov_1kx4056b2s.b[2][1]++;
              }
            } else {
              cov_1kx4056b2s.b[0][1]++;
            }
          },
          onSubmit: function onSubmit(event) {
            cov_1kx4056b2s.f[4]++;
            cov_1kx4056b2s.s[13]++;
            event.preventDefault(); // Consider clearing the send box only after we received POST_ACTIVITY_PENDING
            // E.g. if the connection is bad, sending the message essentially do nothing but just clearing the send box

            cov_1kx4056b2s.s[14]++;

            if (sendBoxValue) {
              cov_1kx4056b2s.b[3][0]++;
              cov_1kx4056b2s.s[15]++;
              scrollToEnd();
              cov_1kx4056b2s.s[16]++;
              submitSendBox();
            } else {
              cov_1kx4056b2s.b[3][1]++;
            }
          },
          value: sendBoxValue
        };
      }
    ].concat(selectors)
  );
};

exports.connectSendTextBox = connectSendTextBox;
cov_1kx4056b2s.s[17]++;

var TextBox = function TextBox(_ref4) {
  var className = _ref4.className,
    disabled = _ref4.disabled,
    onChange = _ref4.onChange,
    onKeyPress = _ref4.onKeyPress,
    onSubmit = _ref4.onSubmit,
    value = _ref4.value;
  cov_1kx4056b2s.f[5]++;

  var _ref5 = (cov_1kx4056b2s.s[18]++, (0, _useStyleOptions.default)()),
    _ref6 = _slicedToArray(_ref5, 1),
    sendBoxTextWrap = _ref6[0].sendBoxTextWrap;

  var _ref7 = (cov_1kx4056b2s.s[19]++, (0, _useStyleSet.default)()),
    _ref8 = _slicedToArray(_ref7, 1),
    _ref8$ = _ref8[0],
    sendBoxTextAreaStyleSet = _ref8$.sendBoxTextArea,
    sendBoxTextBoxStyleSet = _ref8$.sendBoxTextBox;

  var sendBoxString = (cov_1kx4056b2s.s[20]++, (0, _useLocalize.default)('Sendbox'));
  var typeYourMessageString = (cov_1kx4056b2s.s[21]++, (0, _useLocalize.default)('Type your message'));
  cov_1kx4056b2s.s[22]++;
  return _react.default.createElement(
    'form',
    {
      className: (0, _classnames.default)(
        ROOT_CSS + '',
        sendBoxTextAreaStyleSet + '',
        sendBoxTextBoxStyleSet + '',
        className + ''
      ),
      onSubmit: onSubmit
    },
    _react.default.createElement(_TypeFocusSink.Context.Consumer, null, function(_ref9) {
      var sendFocusRef = _ref9.sendFocusRef;
      cov_1kx4056b2s.f[6]++;
      cov_1kx4056b2s.s[23]++;
      return !sendBoxTextWrap
        ? (cov_1kx4056b2s.b[4][0]++,
          _react.default.createElement('input', {
            'aria-label': sendBoxString,
            'data-id': 'webchat-sendbox-input',
            disabled: disabled,
            onChange: onChange,
            placeholder: typeYourMessageString,
            ref: sendFocusRef,
            type: 'text',
            value: value
          }))
        : (cov_1kx4056b2s.b[4][1]++,
          _react.default.createElement(
            'div',
            null,
            _react.default.createElement('textarea', {
              'aria-label': sendBoxString,
              'data-id': 'webchat-sendbox-input',
              disabled: disabled,
              onChange: onChange,
              onKeyPress: onKeyPress,
              placeholder: typeYourMessageString,
              ref: sendFocusRef,
              rows: '1',
              value: value
            }),
            _react.default.createElement('div', null, value + '\n')
          ));
    })
  );
};

cov_1kx4056b2s.s[24]++;
TextBox.defaultProps = {
  className: '',
  disabled: false,
  value: ''
};
cov_1kx4056b2s.s[25]++;
TextBox.propTypes = {
  className: _propTypes.default.string,
  disabled: _propTypes.default.bool,
  onChange: _propTypes.default.func.isRequired,
  onKeyPress: _propTypes.default.func.isRequired,
  onSubmit: _propTypes.default.func.isRequired,
  value: _propTypes.default.string
};

var _default = connectSendTextBox()(TextBox);

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9TZW5kQm94L1RleHRCb3guanMiXSwibmFtZXMiOlsiUk9PVF9DU1MiLCJkaXNwbGF5IiwiZmxleCIsImNvbm5lY3RTZW5kVGV4dEJveCIsInNlbGVjdG9ycyIsImRpc2FibGVkIiwiZm9jdXNTZW5kQm94IiwibGFuZ3VhZ2UiLCJzY3JvbGxUb0VuZCIsInNlbmRCb3hWYWx1ZSIsInNldFNlbmRCb3giLCJzdG9wRGljdGF0ZSIsInN1Ym1pdFNlbmRCb3giLCJvbkNoYW5nZSIsInZhbHVlIiwidGFyZ2V0Iiwib25LZXlQcmVzcyIsImV2ZW50Iiwia2V5Iiwic2hpZnRLZXkiLCJwcmV2ZW50RGVmYXVsdCIsIm9uU3VibWl0IiwiVGV4dEJveCIsImNsYXNzTmFtZSIsInNlbmRCb3hUZXh0V3JhcCIsInNlbmRCb3hUZXh0QXJlYVN0eWxlU2V0Iiwic2VuZEJveFRleHRBcmVhIiwic2VuZEJveFRleHRCb3hTdHlsZVNldCIsInNlbmRCb3hUZXh0Qm94Iiwic2VuZEJveFN0cmluZyIsInR5cGVZb3VyTWVzc2FnZVN0cmluZyIsInNlbmRGb2N1c1JlZiIsImRlZmF1bHRQcm9wcyIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsInN0cmluZyIsImJvb2wiLCJmdW5jIiwiaXNSZXF1aXJlZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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UFA7QUFRRSxNQUFBLEtBQUssRUFBRWpCO0FBUlQsTUFERiwrQkFZRSwwQ0FDRTtBQUNFLG9CQUFZZSxhQURkO0FBRUUsaUJBQVEsdUJBRlY7QUFHRSxNQUFBLFFBQVEsRUFBRXhCLFFBSFo7QUFJRSxNQUFBLFFBQVEsRUFBRVEsUUFKWjtBQUtFLE1BQUEsVUFBVSxFQUFFRyxVQUxkO0FBTUUsTUFBQSxXQUFXLEVBQUVjLHFCQU5mO0FBT0UsTUFBQSxHQUFHLEVBQUVDLFlBUFA7QUFRRSxNQUFBLElBQUksRUFBQyxHQVJQO0FBU0UsTUFBQSxLQUFLLEVBQUVqQjtBQVRULE1BREYsRUFZRSwwQ0FBTUEsS0FBSyxHQUFHLElBQWQsQ0FaRixDQVpGO0FBMEJDLEdBNUJMLENBTEosQ0FERjtBQXdDRCxDQTlDRDs7O0FBZ0RBUSxPQUFPLENBQUNVLFlBQVIsR0FBdUI7QUFDckJULEVBQUFBLFNBQVMsRUFBRSxFQURVO0FBRXJCbEIsRUFBQUEsUUFBUSxFQUFFLEtBRlc7QUFHckJTLEVBQUFBLEtBQUssRUFBRTtBQUhjLENBQXZCOztBQU1BUSxPQUFPLENBQUNXLFNBQVIsR0FBb0I7QUFDbEJWLEVBQUFBLFNBQVMsRUFBRVcsbUJBQVVDLE1BREg7QUFFbEI5QixFQUFBQSxRQUFRLEVBQUU2QixtQkFBVUUsSUFGRjtBQUdsQnZCLEVBQUFBLFFBQVEsRUFBRXFCLG1CQUFVRyxJQUFWLENBQWVDLFVBSFA7QUFJbEJ0QixFQUFBQSxVQUFVLEVBQUVrQixtQkFBVUcsSUFBVixDQUFlQyxVQUpUO0FBS2xCakIsRUFBQUEsUUFBUSxFQUFFYSxtQkFBVUcsSUFBVixDQUFlQyxVQUxQO0FBTWxCeEIsRUFBQUEsS0FBSyxFQUFFb0IsbUJBQVVDO0FBTkMsQ0FBcEI7O2VBU2VoQyxrQkFBa0IsR0FBR21CLE9BQUgsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNzcyB9IGZyb20gJ2dsYW1vcic7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgeyBDb250ZXh0IGFzIFR5cGVGb2N1c1NpbmtDb250ZXh0IH0gZnJvbSAnLi4vVXRpbHMvVHlwZUZvY3VzU2luayc7XG5pbXBvcnQgY29ubmVjdFRvV2ViQ2hhdCBmcm9tICcuLi9jb25uZWN0VG9XZWJDaGF0JztcbmltcG9ydCB1c2VMb2NhbGl6ZSBmcm9tICcuLi9ob29rcy91c2VMb2NhbGl6ZSc7XG5pbXBvcnQgdXNlU3R5bGVPcHRpb25zIGZyb20gJy4uL2hvb2tzL3VzZVN0eWxlT3B0aW9ucyc7XG5pbXBvcnQgdXNlU3R5bGVTZXQgZnJvbSAnLi4vaG9va3MvdXNlU3R5bGVTZXQnO1xuXG5jb25zdCBST09UX0NTUyA9IGNzcyh7XG4gIGRpc3BsYXk6ICdmbGV4JyxcblxuICAnJiA+IGRpdiwgaW5wdXQnOiB7XG4gICAgZmxleDogMVxuICB9XG59KTtcblxuY29uc3QgY29ubmVjdFNlbmRUZXh0Qm94ID0gKC4uLnNlbGVjdG9ycykgPT5cbiAgY29ubmVjdFRvV2ViQ2hhdChcbiAgICAoeyBkaXNhYmxlZCwgZm9jdXNTZW5kQm94LCBsYW5ndWFnZSwgc2Nyb2xsVG9FbmQsIHNlbmRCb3hWYWx1ZSwgc2V0U2VuZEJveCwgc3RvcERpY3RhdGUsIHN1Ym1pdFNlbmRCb3ggfSkgPT4gKHtcbiAgICAgIGRpc2FibGVkLFxuICAgICAgbGFuZ3VhZ2UsXG4gICAgICBvbkNoYW5nZTogKHsgdGFyZ2V0OiB7IHZhbHVlIH0gfSkgPT4ge1xuICAgICAgICBzZXRTZW5kQm94KHZhbHVlKTtcbiAgICAgICAgc3RvcERpY3RhdGUoKTtcbiAgICAgIH0sXG4gICAgICBvbktleVByZXNzOiBldmVudCA9PiB7XG4gICAgICAgIGNvbnN0IHsga2V5LCBzaGlmdEtleSB9ID0gZXZlbnQ7XG5cbiAgICAgICAgaWYgKGtleSA9PT0gJ0VudGVyJyAmJiAhc2hpZnRLZXkpIHtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgaWYgKHNlbmRCb3hWYWx1ZSkge1xuICAgICAgICAgICAgc2Nyb2xsVG9FbmQoKTtcbiAgICAgICAgICAgIHN1Ym1pdFNlbmRCb3goKTtcbiAgICAgICAgICAgIGZvY3VzU2VuZEJveCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uU3VibWl0OiBldmVudCA9PiB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgLy8gQ29uc2lkZXIgY2xlYXJpbmcgdGhlIHNlbmQgYm94IG9ubHkgYWZ0ZXIgd2UgcmVjZWl2ZWQgUE9TVF9BQ1RJVklUWV9QRU5ESU5HXG4gICAgICAgIC8vIEUuZy4gaWYgdGhlIGNvbm5lY3Rpb24gaXMgYmFkLCBzZW5kaW5nIHRoZSBtZXNzYWdlIGVzc2VudGlhbGx5IGRvIG5vdGhpbmcgYnV0IGp1c3QgY2xlYXJpbmcgdGhlIHNlbmQgYm94XG5cbiAgICAgICAgaWYgKHNlbmRCb3hWYWx1ZSkge1xuICAgICAgICAgIHNjcm9sbFRvRW5kKCk7XG4gICAgICAgICAgc3VibWl0U2VuZEJveCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgdmFsdWU6IHNlbmRCb3hWYWx1ZVxuICAgIH0pLFxuICAgIC4uLnNlbGVjdG9yc1xuICApO1xuXG5jb25zdCBUZXh0Qm94ID0gKHsgY2xhc3NOYW1lLCBkaXNhYmxlZCwgb25DaGFuZ2UsIG9uS2V5UHJlc3MsIG9uU3VibWl0LCB2YWx1ZSB9KSA9PiB7XG4gIGNvbnN0IFt7IHNlbmRCb3hUZXh0V3JhcCB9XSA9IHVzZVN0eWxlT3B0aW9ucygpO1xuICBjb25zdCBbeyBzZW5kQm94VGV4dEFyZWE6IHNlbmRCb3hUZXh0QXJlYVN0eWxlU2V0LCBzZW5kQm94VGV4dEJveDogc2VuZEJveFRleHRCb3hTdHlsZVNldCB9XSA9IHVzZVN0eWxlU2V0KCk7XG4gIGNvbnN0IHNlbmRCb3hTdHJpbmcgPSB1c2VMb2NhbGl6ZSgnU2VuZGJveCcpO1xuICBjb25zdCB0eXBlWW91ck1lc3NhZ2VTdHJpbmcgPSB1c2VMb2NhbGl6ZSgnVHlwZSB5b3VyIG1lc3NhZ2UnKTtcblxuICByZXR1cm4gKFxuICAgIDxmb3JtXG4gICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMoUk9PVF9DU1MgKyAnJywgc2VuZEJveFRleHRBcmVhU3R5bGVTZXQgKyAnJywgc2VuZEJveFRleHRCb3hTdHlsZVNldCArICcnLCBjbGFzc05hbWUgKyAnJyl9XG4gICAgICBvblN1Ym1pdD17b25TdWJtaXR9XG4gICAgPlxuICAgICAge1xuICAgICAgICA8VHlwZUZvY3VzU2lua0NvbnRleHQuQ29uc3VtZXI+XG4gICAgICAgICAgeyh7IHNlbmRGb2N1c1JlZiB9KSA9PlxuICAgICAgICAgICAgIXNlbmRCb3hUZXh0V3JhcCA/IChcbiAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgYXJpYS1sYWJlbD17c2VuZEJveFN0cmluZ31cbiAgICAgICAgICAgICAgICBkYXRhLWlkPVwid2ViY2hhdC1zZW5kYm94LWlucHV0XCJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0eXBlWW91ck1lc3NhZ2VTdHJpbmd9XG4gICAgICAgICAgICAgICAgcmVmPXtzZW5kRm9jdXNSZWZ9XG4gICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICAgIHZhbHVlPXt2YWx1ZX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPXtzZW5kQm94U3RyaW5nfVxuICAgICAgICAgICAgICAgICAgZGF0YS1pZD1cIndlYmNoYXQtc2VuZGJveC1pbnB1dFwiXG4gICAgICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgICAgICAgICAgICBvbktleVByZXNzPXtvbktleVByZXNzfVxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3R5cGVZb3VyTWVzc2FnZVN0cmluZ31cbiAgICAgICAgICAgICAgICAgIHJlZj17c2VuZEZvY3VzUmVmfVxuICAgICAgICAgICAgICAgICAgcm93cz1cIjFcIlxuICAgICAgICAgICAgICAgICAgdmFsdWU9e3ZhbHVlfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPGRpdj57dmFsdWUgKyAnXFxuJ308L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApXG4gICAgICAgICAgfVxuICAgICAgICA8L1R5cGVGb2N1c1NpbmtDb250ZXh0LkNvbnN1bWVyPlxuICAgICAgfVxuICAgIDwvZm9ybT5cbiAgKTtcbn07XG5cblRleHRCb3guZGVmYXVsdFByb3BzID0ge1xuICBjbGFzc05hbWU6ICcnLFxuICBkaXNhYmxlZDogZmFsc2UsXG4gIHZhbHVlOiAnJ1xufTtcblxuVGV4dEJveC5wcm9wVHlwZXMgPSB7XG4gIGNsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgZGlzYWJsZWQ6IFByb3BUeXBlcy5ib29sLFxuICBvbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25LZXlQcmVzczogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25TdWJtaXQ6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIHZhbHVlOiBQcm9wVHlwZXMuc3RyaW5nXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb25uZWN0U2VuZFRleHRCb3goKShUZXh0Qm94KTtcblxuZXhwb3J0IHsgY29ubmVjdFNlbmRUZXh0Qm94IH07XG4iXX0=
